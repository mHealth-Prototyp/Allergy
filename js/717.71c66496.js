"use strict";(globalThis["webpackChunkmhealth_proto_patient"]=globalThis["webpackChunkmhealth_proto_patient"]||[]).push([[717],{6504:(e,t,l)=>{l.r(t),l.d(t,{default:()=>gl});var a=l(9835);const s={class:"full-width row justify-around"};function n(e,t,l,n,o,i){const r=(0,a.up)("TimelineCard"),d=(0,a.up)("AirQualityTimelineCard"),c=(0,a.up)("PollenMapCard"),u=(0,a.up)("AllergyCard"),p=(0,a.up)("DiaryEntryCard"),g=(0,a.up)("DiaryListCard"),m=(0,a.up)("CalendarCard"),y=(0,a.up)("q-dialog"),h=(0,a.up)("DashboardFAB");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[e.showTimelineCard?((0,a.wg)(),(0,a.j4)(r,{key:0,diary:e.diary,range:e.range},null,8,["diary","range"])):(0,a.kq)("",!0),e.showAirQualityCard?((0,a.wg)(),(0,a.j4)(d,{key:1,station:e.station,pollen:e.pollen,range:e.range},null,8,["station","pollen","range"])):(0,a.kq)("",!0),e.showPollenMap?((0,a.wg)(),(0,a.j4)(c,{key:2,station:e.station,pollen:e.pollen},null,8,["station","pollen"])):(0,a.kq)("",!0),e.showAllergyCard?((0,a.wg)(),(0,a.j4)(u,{key:3,confirmedAllergies:e.$store.getKnownAllergies(!0),suspectedAllergies:e.$store.getSuspectedAllergiesAsFhir((t=>e.$t("symptom."+t))),entriesPerPage:5},null,8,["confirmedAllergies","suspectedAllergies"])):(0,a.kq)("",!0),e.showNewEntryCard?((0,a.wg)(),(0,a.j4)(p,{key:4,entry:void 0,dashBoardMode:"",onCreateEntry:e.createEntry},null,8,["onCreateEntry"])):(0,a.kq)("",!0),e.showDiaryListCard?((0,a.wg)(),(0,a.j4)(g,{key:5,diary:e.diary,entriesPerPage:5,onSelectedEntry:e.showEntry,onRequestNewEntry:t[0]||(t[0]=t=>{e.displayEntry=void 0,e.diaryDialog=!0})},null,8,["diary","onSelectedEntry"])):(0,a.kq)("",!0),e.showCalendarCard?((0,a.wg)(),(0,a.j4)(m,{key:6,diary:e.diary},null,8,["diary"])):(0,a.kq)("",!0),e.showDiaryListCard?((0,a.wg)(),(0,a.j4)(y,{key:7,modelValue:e.diaryDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.diaryDialog=t),"no-backdrop-dismiss":"",class:"dialog"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{entry:e.displayEntry,onClose:t[1]||(t[1]=t=>e.diaryDialog=!1),onCreateEntry:e.createEntry},null,8,["entry","onCreateEntry"])])),_:1},8,["modelValue"])):(0,a.kq)("",!0)]),(0,a.Wm)(h,{onOffsetChanged:e.offsetChanged,onDashboardSettingsChanged:e.dashboardSettingsChanged,onStationChanged:e.stationChanged,onPollenChanged:e.pollenChanged},null,8,["onOffsetChanged","onDashboardSettingsChanged","onStationChanged","onPollenChanged"])],64)}var o=l(6970),i=l(1957);const r=e=>((0,a.dD)("data-v-f1ca1038"),e=e(),(0,a.Cn)(),e),d={key:0,class:"row"},c={class:"col-4"},u={class:"form-label"},p={class:"col-8"},g={class:"datetime-wrapper"},m={key:1},y={key:2,class:"row"},h={class:"col-4"},w={class:"form-label"},f={class:"col-8"},b={key:0,style:{"text-align":"left","font-size":"small"}},k={class:"editable-list"},C={class:"radio-group"},D={class:"intensity-label"},$=r((()=>(0,a._)("br",null,null,-1))),v={key:0},_=r((()=>(0,a._)("hr",null,null,-1))),A={key:3,class:"row"},q={class:"col-4"},P={class:"form-label"},S={class:"col-8"},W={key:0,style:{"text-align":"left","font-size":"small"}},Z={key:3,class:"display"},x={key:4},E={key:5,class:"row"},V={class:"col-4"},z={class:"form-label"},Q={class:"col-8"},M={key:0,style:{"text-align":"left","font-size":"small"}},U={key:2},L={key:6},j={key:7,class:"row"},T={class:"col-4"},O={class:"form-label"},I={class:"col-8"},F={key:0,class:"display-note"},Y=["placeholder"],B={key:0};function H(e,t,l,s,n,r){const H=(0,a.up)("q-icon"),N=(0,a.up)("q-card-section"),K=(0,a.up)("q-date"),R=(0,a.up)("q-time"),X=(0,a.up)("q-popup-edit"),G=(0,a.up)("q-select"),J=(0,a.up)("q-radio"),ee=(0,a.up)("q-btn"),te=(0,a.up)("q-card-actions"),le=(0,a.up)("q-card"),ae=(0,a.up)("suspected-allergies-card"),se=(0,a.up)("q-dialog"),ne=(0,a.up)("preferred-medication-card"),oe=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(le,{class:(0,o.C_)((e.dashBoardMode," dashboard-card"))},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{class:(0,o.C_)("card-title"+(e.dashBoardMode?"":" with-close-icon"))},{default:(0,a.w5)((()=>[e.dashBoardMode?((0,a.wg)(),(0,a.j4)(H,{key:0,name:"fas fa-book-medical",class:"big-icon"})):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,o.zw)("display"===e.mode?e.$t("diary.title")+" "+new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(e.date):e.$t("diary.createTitle"))+" ",1),e.dashBoardMode?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.j4)(H,{key:1,onClick:t[0]||(t[0]=t=>e.$emit("close")),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512)),[[oe]])])),_:1},8,["class"]),(0,a.Wm)(N,null,{default:(0,a.w5)((()=>["create"===e.mode?((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",c,[(0,a._)("span",u,(0,o.zw)(e.$t("diary.dateLabel")),1)]),(0,a._)("div",p,[(0,a._)("span",{class:(0,o.C_)("create"===e.mode?"editable":"")},[(0,a.Uk)((0,o.zw)("function"===typeof e.date.getMonth?new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(e.date):e.date)+" ",1),"create"===e.mode?((0,a.wg)(),(0,a.j4)(X,{key:0,modelValue:e.date,"onUpdate:modelValue":t[1]||(t[1]=t=>e.date=t),"auto-save":"",title:e.$t("diary.editDate"),onBeforeHide:t[2]||(t[2]=()=>{e.date=new Date(e.date)}),buttons:"","label-set":e.$t("common.save")},{default:(0,a.w5)((t=>[(0,a._)("div",g,[(0,a.Wm)(K,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,mask:"YYYY-MM-DD HH:mm",style:{"margin-right":"1em"},minimal:"",flat:"",options:e.dateSelectorOptions},null,8,["modelValue","onUpdate:modelValue","options"]),(0,a.Wm)(R,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,mask:"YYYY-MM-DD HH:mm",flat:"","default-date":`${e.$today.getFullYear()}/${("0"+(e.$today.getMonth()+1)).slice(-2)}/${("0"+e.$today.getDate()).slice(-2)}`},null,8,["modelValue","onUpdate:modelValue","default-date"])])])),_:1},8,["modelValue","title","label-set"])):(0,a.kq)("",!0)],2)])])):(0,a.kq)("",!0),"create"===e.mode?((0,a.wg)(),(0,a.iD)("hr",m)):(0,a.kq)("",!0),e.symptoms.length>0||"create"===e.mode?((0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",h,[(0,a._)("span",w,(0,o.zw)(e.$t("diary.symptomsLabel")),1)]),(0,a._)("div",f,["create"===e.mode?((0,a.wg)(),(0,a.iD)("p",b,(0,o.zw)(e.$t("diary.symptomsHint")),1)):(0,a.kq)("",!0),(0,a._)("ul",k,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.symptoms,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l},[(0,a._)("span",{class:(0,o.C_)("create"===e.mode?"editable":"")},[(0,a.Uk)((0,o.zw)(e.$t("symptom."+t.location.name))+" ("+(0,o.zw)(e.$t("symptom."+t.intensity))+") ",1),"create"===e.mode?((0,a.wg)(),(0,a.j4)(X,{key:0,modelValue:e.symptoms[l],"onUpdate:modelValue":t=>e.symptoms[l]=t,"auto-save":"",buttons:"",title:e.$t("diary.newSymptom"),"label-set":e.$t("common.save"),validate:()=>e.validateSymptom(e.symptoms[l])},{default:(0,a.w5)((()=>[(0,a.Wm)(G,{modelValue:e.symptoms[l].location,"onUpdate:modelValue":t=>e.symptoms[l].location=t,label:e.$t("symptom.location"),autofocus:"",options:e.symptomLocations,"option-label":t=>t&&t.name?e.$t("symptom."+t.name):""},null,8,["modelValue","onUpdate:modelValue","label","options","option-label"]),(0,a._)("div",C,[(0,a._)("span",D,(0,o.zw)(e.$t("diary.intensity")),1),(0,a.Wm)(J,{modelValue:e.symptoms[l].intensity,"onUpdate:modelValue":t=>e.symptoms[l].intensity=t,val:"255604002",size:"xs"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("symptom.255604002")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,a.Wm)(J,{modelValue:e.symptoms[l].intensity,"onUpdate:modelValue":t=>e.symptoms[l].intensity=t,val:"6736007",size:"md"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("symptom.6736007")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,a.Wm)(J,{modelValue:e.symptoms[l].intensity,"onUpdate:modelValue":t=>e.symptoms[l].intensity=t,val:"24484000",size:"xl"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("symptom.24484000")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),$,(0,a.Wm)(J,{modelValue:e.symptoms[l].intensity,"onUpdate:modelValue":t=>e.symptoms[l].intensity=t,val:"260413007"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("symptom.260413007")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:2},1032,["modelValue","onUpdate:modelValue","title","label-set","validate"])):(0,a.kq)("",!0)],2),"create"===e.mode?((0,a.wg)(),(0,a.j4)(H,{key:0,name:"fas fa-trash",class:"add-delete-icon",onClick:()=>e.symptoms.splice(l,1)},null,8,["onClick"])):(0,a.kq)("",!0),"create"===e.mode&&l===e.symptoms.length-1?((0,a.wg)(),(0,a.j4)(H,{key:1,name:"fas fa-plus",class:"inline-icon add-delete-icon",onClick:e.addNewSymptom},null,8,["onClick"])):(0,a.kq)("",!0)])))),128)),0===e.symptoms.length?((0,a.wg)(),(0,a.iD)("li",v,[(0,a._)("span",{class:"editable",onClick:t[3]||(t[3]=(...t)=>e.addNewSymptom&&e.addNewSymptom(...t))},(0,o.zw)(e.$t("diary.noSymptoms")),1),(0,a.Wm)(H,{name:"fas fa-plus",class:"inline-icon add-delete-icon",onClick:e.addNewSymptom},null,8,["onClick"])])):(0,a.kq)("",!0)])])])):(0,a.kq)("",!0),_,e.allergy||"create"===e.mode?((0,a.wg)(),(0,a.iD)("div",A,[(0,a._)("div",q,[(0,a._)("span",P,(0,o.zw)(e.$t("diary.allergyLabel")),1)]),(0,a._)("div",S,["create"===e.mode?((0,a.wg)(),(0,a.iD)("p",W,(0,o.zw)(e.$t("diary.allergyHint")),1)):(0,a.kq)("",!0),"create"===e.mode&&(e.availableAllergies.length>0||e.suspectedAllergies.length>0)?((0,a.wg)(),(0,a.j4)(G,{key:1,modelValue:e.allergy,"onUpdate:modelValue":t[4]||(t[4]=t=>e.allergy=t),options:e.availableAllergies,"options-dense":"",dense:"","option-label":t=>t?t.languageDisplays[e.lang]:"keine Allergie",clearable:""},null,8,["modelValue","options","option-label"])):(0,a.kq)("",!0),"create"===e.mode?((0,a.wg)(),(0,a.j4)(ee,{key:2,onClick:t[5]||(t[5]=t=>e.showSuspectedAllergiesPopup=!0),label:e.$t("suspectedAllergies.button"),class:"add-suspected-button",flat:"",size:"sm"},null,8,["label"])):(0,a.kq)("",!0),"display"===e.mode?((0,a.wg)(),(0,a.iD)("span",Z,(0,o.zw)(e.allergy?e.allergy.languageDisplays[e.lang]:""),1)):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),e.allergy||"create"===e.mode?((0,a.wg)(),(0,a.iD)("hr",x)):(0,a.kq)("",!0),e.medications.length>0||"create"===e.mode?((0,a.wg)(),(0,a.iD)("div",E,[(0,a._)("div",V,[(0,a._)("span",z,(0,o.zw)(e.$t("diary.medicationsLabel")),1)]),(0,a._)("div",Q,["create"===e.mode?((0,a.wg)(),(0,a.iD)("p",M,(0,o.zw)(e.$t("diary.medicationsHint")),1)):(0,a.kq)("",!0),"create"===e.mode&&e.preferredMedication.length>0?((0,a.wg)(),(0,a.j4)(G,{key:1,modelValue:e.medications,"onUpdate:modelValue":t[6]||(t[6]=t=>e.medications=t),options:e.preferredMedication,multiple:"","options-dense":"",dense:"","use-chips":"","option-label":e.medicationsOptionLabel},null,8,["modelValue","options","option-label"])):(0,a.kq)("",!0),"display"===e.mode?((0,a.wg)(),(0,a.iD)("ul",U,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.medications,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l},(0,o.zw)(e.medicationsOptionLabel(t)),1)))),128))])):(0,a.kq)("",!0),"create"===e.mode?((0,a.wg)(),(0,a.j4)(ee,{key:3,onClick:t[7]||(t[7]=t=>e.showPreferredMedicationPopup=!0),label:e.$t("preferredMedication.button"),class:"add-suspected-button",flat:"",size:"sm"},null,8,["label"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),e.medications.length>0||"create"===e.mode?((0,a.wg)(),(0,a.iD)("hr",L)):(0,a.kq)("",!0),"create"===e.mode||e.note&&e.note.length>0?((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("div",T,[(0,a._)("span",O,(0,o.zw)(e.$t("diary.noteLabel")),1)]),(0,a._)("div",I,["display"===e.mode?((0,a.wg)(),(0,a.iD)("p",F,(0,o.zw)(e.note),1)):(0,a.kq)("",!0),"create"===e.mode?(0,a.wy)(((0,a.wg)(),(0,a.iD)("textarea",{key:1,"onUpdate:modelValue":t[8]||(t[8]=t=>e.note=t),placeholder:e.$t("diary.noteHint"),class:"edit-note editable"},"\n          ",8,Y)),[[i.nr,e.note]]):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)])),_:1}),"create"===e.mode?((0,a.wg)(),(0,a.iD)("hr",B)):(0,a.kq)("",!0),"create"===e.mode?((0,a.wg)(),(0,a.j4)(te,{key:1,align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(ee,{label:e.$t("common.save"),onClick:e.saveEntry,disable:e.disableButton},null,8,["label","onClick","disable"])])),_:1})):(0,a.kq)("",!0)])),_:1},8,["class"]),(0,a.Wm)(se,{modelValue:e.showSuspectedAllergiesPopup,"onUpdate:modelValue":t[9]||(t[9]=t=>e.showSuspectedAllergiesPopup=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{availableAllergies:e.allergyCodes,suspectedAllergies:e.suspectedAllergies,onClose:e.onCloseSuspectedAllergiesPopup},null,8,["availableAllergies","suspectedAllergies","onClose"])])),_:1},8,["modelValue"]),(0,a.Wm)(se,{modelValue:e.showPreferredMedicationPopup,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showPreferredMedicationPopup=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(ne,{onClose:e.onClosePreferredMedication},null,8,["onClose"])])),_:1},8,["modelValue"])],64)}var N=l(3102),K=l(5993),R=l(1839);const X=["onClick"];function G(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-select"),u=(0,a.up)("q-btn"),p=(0,a.up)("q-card-actions"),g=(0,a.up)("q-card"),m=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(g,{class:"suspected-allergies-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("suspectedAllergies.title"))+" ",1),(0,a.wy)((0,a.Wm)(r,{onClick:t[0]||(t[0]=t=>e.$emit("close",{save:!1,allergies:[]})),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[m]])])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,o.zw)(e.$t("suspectedAllergies.explanation")),1),(0,a.Wm)(c,{modelValue:e.allergies,"onUpdate:modelValue":t[1]||(t[1]=t=>e.allergies=t),label:e.$t("common.typeForSearch"),options:e.searchAllergies,multiple:"","options-dense":"","hide-selected":"","use-input":"","option-label":t=>t&&t.languageDisplays[e.lang],onFilter:t[2]||(t[2]=(t,l)=>{const a=t.toLowerCase();""!==t&&l((()=>{e.searchAllergies=e.availableAllergies.filter((t=>t.languageDisplays[e.lang].toLowerCase().includes(a)))}))})},null,8,["modelValue","label","options","option-label"]),(0,a._)("ul",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.allergies,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:t.defaultCoding.code},[(0,a.Uk)((0,o.zw)(t.languageDisplays[e.lang])+" ",1),(0,a._)("span",{onClick:()=>e.allergies.splice(l,1),class:"delete-x",style:{cursor:"pointer"}}," [ "+(0,o.zw)(e.$t("common.remove"))+" ] ",9,X)])))),128))])])),_:1}),(0,a.Wm)(p,{align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:e.$t("common.save"),onClick:t[3]||(t[3]=t=>e.$emit("close",{save:!0,allergies:e.allergies}))},null,8,["label"])])),_:1})])),_:1})}var J=l(7861);const ee=(0,a.aZ)({name:"SuspectedAllergiesCard",data(){return{allergies:this.suspectedAllergies.slice(),searchAllergies:this.availableAllergies.slice(),lang:(0,J.getLangStringFromLocale)(this.$i18n.locale)}},emits:{close:e=>!0},props:{availableAllergies:{type:Array,required:!0},suspectedAllergies:{type:Array,required:!0}},methods:{}});var te=l(1639),le=l(4458),ae=l(3190),se=l(2857),ne=l(6384),oe=l(1821),ie=l(4455),re=l(2146),de=l(9984),ce=l.n(de);const ue=(0,te.Z)(ee,[["render",G],["__scopeId","data-v-49817be2"]]),pe=ue;ce()(ee,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QSelect:ne.Z,QCardActions:oe.Z,QBtn:ie.Z}),ce()(ee,"directives",{ClosePopup:re.Z});var ge=l(4095);const me=["onClick"];function ye(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-select"),u=(0,a.up)("q-btn"),p=(0,a.up)("q-card-actions"),g=(0,a.up)("q-card"),m=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(g,{class:"preferred-card-medication-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("preferredMedication.title"))+" ",1),(0,a.wy)((0,a.Wm)(r,{onClick:t[0]||(t[0]=t=>e.close(!1)),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[m]])])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,o.zw)(e.$t("preferredMedication.explanation")),1),(0,a.Wm)(c,{modelValue:e.medications,"onUpdate:modelValue":t[1]||(t[1]=t=>e.medications=t),label:e.$t("common.typeForSearch"),options:e.searchMedications,multiple:"","options-dense":"","hide-selected":"","use-input":"","option-label":e.medicationsOptionLabel,onFilter:t[2]||(t[2]=(t,l)=>{""!==t&&l((()=>{e.searchMedications=e.availableMedication.filter((l=>e.medicationsOptionLabel(l).toLowerCase().includes(t.toLowerCase())))}))})},null,8,["modelValue","label","options","option-label"]),(0,a._)("ul",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.medications,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l},[(0,a.Uk)((0,o.zw)(e.medicationsOptionLabel(t))+" ",1),(0,a._)("span",{onClick:()=>e.medications.splice(l,1),class:"delete-x",style:{cursor:"pointer"}}," [ "+(0,o.zw)(e.$t("common.remove"))+" ] ",9,me)])))),128))])])),_:1}),(0,a.Wm)(p,{align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:e.$t("common.save"),onClick:t[3]||(t[3]=t=>e.close(!0))},null,8,["label"])])),_:1})])),_:1})}var he=l(3349);const we=(0,a.aZ)({name:"PreferredMedicationCard",data(){return{lang:(0,J.getLangStringFromLocale)(this.$i18n.locale),medications:[...this.$store.getPreferredMedication()],searchMedications:[],availableMedication:he.p}},methods:{medicationsOptionLabel(e){var t,l,a,s;let n=this.$t("common.error");return(null===(t=e.code)||void 0===t?void 0:t._text)?n=null!==(l=(0,ge.readI18N)(e.code._text,this.lang))&&void 0!==l?l:n:(null===(a=e.code)||void 0===a?void 0:a.text)&&(n=null!==(s=e.code.text)&&void 0!==s?s:n),n},close(e){e&&this.$store.setPreferredMedication(this.medications),this.$emit("close",{save:e})}}}),fe=(0,te.Z)(we,[["render",ye]]),be=fe;var ke;ce()(we,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QSelect:ne.Z,QCardActions:oe.Z,QBtn:ie.Z}),ce()(we,"directives",{ClosePopup:re.Z}),function(e){e["DISPLAY"]="display",e["CREATE"]="create"}(ke||(ke={}));const Ce={intensity:K.Bs.NONE,location:{name:"unknown",sct:"261665006",image:"none.json",defaultCoding:{system:"http://snomed.info/sct",code:"261665006",display:"Unknown (qualifier value)"}}},De=(0,a.aZ)({name:"DiaryEntryCard",components:{SuspectedAllergiesCard:pe,PreferredMedicationCard:be},data(){return{mode:this.$props.entry?ke.DISPLAY:ke.CREATE,date:this.$today,symptoms:new Array,note:void 0,allergy:void 0,symptomLocations:R.$,knownAllergyCodes:new Array,availableAllergies:new Array,suspectedAllergies:new Array,allergyCodes:new Array,lang:(0,J.getLangStringFromLocale)(this.$i18n.locale),showSuspectedAllergiesPopup:!1,showPreferredMedicationPopup:!1,medications:new Array,preferredMedication:this.$store.getPreferredMedication()}},emits:{"create-entry":e=>void 0!==e.date,close:()=>!0},props:{entry:{type:Object,required:!1},dashBoardMode:{type:Boolean,required:!1}},beforeMount(){this.knownAllergyCodes=this.$store.getKnownAllergies().map((e=>{const t=e.code.coding?e.code.coding.find((e=>"http://snomed.info/sct"===e.system)):void 0;let l=N.bt[0];return t&&t.code&&(l=N.bt.find((e=>e.defaultCoding.code===t.code))||l),l})),this.suspectedAllergies=this.$store.getSuspectedAllergies(),this.resetAllergyCodes()},mounted(){this.$props.entry&&Object.assign(this,this.$props.entry),this.resetAvailableAllergies()},computed:{disableButton(){var e;return(0===this.symptoms.length||1===this.symptoms.length&&this.symptoms[0]===Ce)&&(void 0==this.note||0===(null===(e=this.note)||void 0===e?void 0:e.length))&&void 0==this.allergy}},methods:{saveEntry(){this.$emit("create-entry",{date:new Date(this.date),symptoms:[...this.symptoms.filter((e=>"unknown"!==e.location.name))],note:this.note&&this.note.length>0?this.note:void 0,allergy:this.allergy?Object.assign({},this.allergy):void 0,medications:[...this.medications]}),this.resetForm(),this.dashBoardMode||this.$emit("close")},resetForm(){this.date=this.$today,this.symptoms=[],this.note="",this.allergy=void 0,this.medications=[]},onCloseSuspectedAllergiesPopup(e){e.save&&(this.suspectedAllergies=e.allergies,this.$store.setSuspectedAllergies(e.allergies),this.resetAvailableAllergies()),this.showSuspectedAllergiesPopup=!1},onClosePreferredMedication(e){e.save&&(this.preferredMedication=this.$store.getPreferredMedication()),this.showPreferredMedicationPopup=!1},addNewSymptom(){this.symptoms.push(Object.assign({},Ce))},validateSymptom(e){return void 0!==e.location&&"261665006"!==e.location.sct||(alert(this.$t("diary.locationAlert")),!1)},resetAvailableAllergies(){function e(e,t){const l=new Array;return e.forEach((e=>l.push(e))),t.forEach((t=>{-1===e.findIndex((e=>e.defaultCoding.code===t.defaultCoding.code))&&l.push(t)})),l}this.availableAllergies=e(this.knownAllergyCodes,this.suspectedAllergies).filter((e=>e.defaultCoding.display&&!e.defaultCoding.display.includes("No known"))).sort(((e,t)=>(e.defaultCoding.display||"").localeCompare(t.defaultCoding.display||"")))},resetAllergyCodes(){this.allergyCodes=N.bt.filter((e=>{var t,l;return!this.suspectedAllergies.includes(e)&&!this.knownAllergyCodes.includes(e)&&!(null===(t=e.defaultCoding.display)||void 0===t?void 0:t.includes("No known"))&&!(null===(l=e.defaultCoding.display)||void 0===l?void 0:l.includes("Allergy to"))}))},medicationsOptionLabel(e){var t,l,a,s;let n=this.$t("common.error");return(null===(t=e.code)||void 0===t?void 0:t._text)?n=null!==(l=(0,ge.readI18N)(e.code._text,this.lang))&&void 0!==l?l:n:(null===(a=e.code)||void 0===a?void 0:a.text)&&(n=null!==(s=e.code.text)&&void 0!==s?s:n),n},dateSelectorOptions(e){return e<=`${this.$today.getFullYear()}/${`0${this.$today.getMonth()+1}`.slice(-2)}/${`0${this.$today.getDate()}`.slice(-2)}`}},watch:{}});var $e=l(5863),ve=l(4351),_e=l(6770),Ae=l(1480),qe=l(2074);const Pe=(0,te.Z)(De,[["render",H],["__scopeId","data-v-f1ca1038"]]),Se=Pe;ce()(De,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QPopupEdit:$e.Z,QDate:ve.Z,QTime:_e.Z,QSelect:ne.Z,QRadio:Ae.Z,QBtn:ie.Z,QCardActions:oe.Z,QDialog:qe.Z}),ce()(De,"directives",{ClosePopup:re.Z});const We=e=>((0,a.dD)("data-v-46f78a7e"),e=e(),(0,a.Cn)(),e),Ze={class:"intro-text"},xe={key:0,class:"no-data-text"},Ee={class:"diary-entries"},Ve=["onClick"],ze={class:"diary-entry-button-title"},Qe={class:"diary-entry-button-date"},Me={key:1,class:"diary-pages"},Ue=["onClick"],Le={key:0},je=We((()=>(0,a._)("hr",null,null,-1)));function Te(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-btn"),u=(0,a.up)("q-card-actions"),p=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(p,{class:"dashboard-card diary-list-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-book",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("index.diaryTitle")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("p",Ze,(0,o.zw)(e.$t("index.diaryText")),1),0===e.diary.length?((0,a.wg)(),(0,a.iD)("p",xe,(0,o.zw)(e.$t("diary.noData")),1)):(0,a.kq)("",!0),(0,a._)("ul",Ee,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.diaryEntries,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:"diaryEntry."+l},[(0,a._)("div",{class:"diary-entry-button",onClick:l=>e.$emit("selected-entry",t)},[(0,a._)("p",ze,(0,o.zw)(e.$t("diary.title")),1),(0,a._)("p",Qe,(0,o.zw)(new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"medium",timeStyle:"short"}).format(t.date)),1)],8,Ve)])))),128))]),e.diaryPages>1?((0,a.wg)(),(0,a.iD)("ul",Me,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.diaryPages,(t=>((0,a.wg)(),(0,a.iD)("li",{key:"pagebutton"+t},[(0,a._)("span",{onClick:()=>e.setDiaryPage(t),class:(0,o.C_)(t===e.currentDiaryPage?"clickable current-page":"clickable")},"  "+(0,o.zw)(t)+"  ",11,Ue),t!==e.diaryPages?((0,a.wg)(),(0,a.iD)("span",Le,"•")):(0,a.kq)("",!0)])))),128))])):(0,a.kq)("",!0)])),_:1}),je,(0,a.Wm)(u,{align:"center",class:"card-actions"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{label:e.$t("diary.createTitle"),onClick:t[0]||(t[0]=t=>e.$emit("request-new-entry"))},null,8,["label"])])),_:1})])),_:1})}const Oe=(0,a.aZ)({name:"DiaryListCard",components:{},data(){return{diaryEntries:new Array,diaryPages:0,currentDiaryPage:0}},emits:{"selected-entry":e=>void 0!==e.date,"request-new-entry":()=>!0},props:{diary:{type:Array,required:!0},entriesPerPage:{type:Number,required:!0}},mounted(){this.setDiaryPage(1),this.diaryPages=Math.ceil(this.$props.diary.length/this.$props.entriesPerPage)},watch:{diary(e){this.diaryEntries=e,this.setDiaryPage(-1)}},methods:{setDiaryPage(e){this.diaryPages=Math.ceil(this.$props.diary.length/this.$props.entriesPerPage),this.currentDiaryPage=-1===e?this.diaryPages:e;const t=(this.currentDiaryPage-1)*this.$props.entriesPerPage;this.diaryEntries=this.$props.diary.slice(t,t+this.$props.entriesPerPage)}}}),Ie=(0,te.Z)(Oe,[["render",Te],["__scopeId","data-v-46f78a7e"]]),Fe=Ie;ce()(Oe,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QCardActions:oe.Z,QBtn:ie.Z});const Ye={class:"allergy-button-list"},Be=["onClick"],He={key:0,class:"allergy-button-type"},Ne={class:"allergy-button-name"},Ke={key:0,class:"no-entries"},Re={key:1,class:"pages"},Xe=["onClick"],Ge={key:0},Je={class:"allergy-button-list"},et=["onClick"],tt={class:"allergy-button-type"},lt={class:"allergy-button-name"},at={key:0,class:"no-entries"},st={key:1,class:"pages"},nt=["onClick"],ot={key:0};function it(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-tab"),u=(0,a.up)("q-tabs"),p=(0,a.up)("q-card"),g=(0,a.up)("AllergyView"),m=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{class:"dashboard-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-stethoscope",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("allergy.title")),1)])),_:1}),e.suspectedAllergies?((0,a.wg)(),(0,a.j4)(u,{key:0,modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{name:"known",label:e.$t(e.smallScreen?"allergy.tabKnownShort":"allergy.tabKnown")},null,8,["label"]),(0,a.Wm)(c,{name:"suspected",label:e.$t(e.smallScreen?"allergy.tabSuspectedShort":"allergy.tabSuspected")},null,8,["label"])])),_:1},8,["modelValue"])):(0,a.kq)("",!0),"known"!==e.tab&&e.suspectedAllergies?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(d,{key:1},{default:(0,a.w5)((()=>[(0,a._)("ul",Ye,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.allergies.known,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id,class:"clickable allergy-button",onClick:()=>{e.detailDialog=!0,e.selectedAllergy=t}},[t.type?((0,a.wg)(),(0,a.iD)("p",He,(0,o.zw)(e.$t("common."+t.type)),1)):(0,a.kq)("",!0),(0,a._)("p",Ne,(0,o.zw)(e.getAllergyName(t)),1)],8,Be)))),128))]),0===e.allergies.known.length?((0,a.wg)(),(0,a.iD)("p",Ke,(0,o.zw)(e.$t("allergy.noEntries")),1)):(0,a.kq)("",!0),e.pages.known>1?((0,a.wg)(),(0,a.iD)("ul",Re,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.pages.known,(t=>((0,a.wg)(),(0,a.iD)("li",{key:"knownpagebutton"+t},[(0,a._)("span",{onClick:()=>e.setAllergyPage(t,"known"),class:(0,o.C_)(t===e.currentPage.known?"clickable current-page":"clickable")},"  "+(0,o.zw)(t)+"  ",11,Xe),t!==e.pages.known?((0,a.wg)(),(0,a.iD)("span",Ge,"•")):(0,a.kq)("",!0)])))),128))])):(0,a.kq)("",!0)])),_:1})),"suspected"===e.tab?((0,a.wg)(),(0,a.j4)(d,{key:2},{default:(0,a.w5)((()=>[(0,a._)("ul",Je,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.allergies.suspected,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id,class:"clickable allergy-button",onClick:()=>{e.detailDialog=!0,e.selectedAllergy=t}},[(0,a._)("p",tt,(0,o.zw)(e.$t("allergy.suspectedSubtitle")),1),(0,a._)("p",lt,(0,o.zw)(e.getAllergyName(t)),1)],8,et)))),128))]),0===e.allergies.suspected.length?((0,a.wg)(),(0,a.iD)("p",at,(0,o.zw)(e.$t("allergy.noEntries")),1)):(0,a.kq)("",!0),e.pages.suspected>1?((0,a.wg)(),(0,a.iD)("ul",st,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.pages.suspected,(t=>((0,a.wg)(),(0,a.iD)("li",{key:"knownpagebutton"+t},[(0,a._)("span",{onClick:()=>e.setAllergyPage(t,"suspected"),class:(0,o.C_)(t===e.currentPage.suspected?"clickable current-page":"clickable")},"  "+(0,o.zw)(t)+"  ",11,nt),t!==e.pages.suspected?((0,a.wg)(),(0,a.iD)("span",ot,"•")):(0,a.kq)("",!0)])))),128))])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(m,{modelValue:e.detailDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.detailDialog=t),class:"dialog"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"allergy-dialog-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title with-close-icon"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.selectedAllergy?e.getAllergyName(e.selectedAllergy):"")+" ",1),(0,a.wy)((0,a.Wm)(r,{onClick:t[1]||(t[1]=()=>{e.detailDialog=!1,e.selectedAllergy=void 0}),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[y]])])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{allergyIntolerance:e.selectedAllergy,languageString:e.lang,fhirUtils:e.$fhirUtils,epdPlaygroundUtils:e.$epdUtils,showTitle:!1},null,8,["allergyIntolerance","languageString","fhirUtils","epdPlaygroundUtils"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const rt=(0,a.aZ)({name:"AllergyCard",components:{AllergyView:N.HY},data(){return{lang:this.$i18n.locale.substring(0,2),smallScreen:window.innerWidth<400,allergies:{known:new Array,suspected:new Array},pages:{known:0,suspected:0},currentPage:{known:0,suspected:0},tab:"known",detailDialog:!1,selectedAllergy:void 0}},props:{confirmedAllergies:{type:Object,required:!0},suspectedAllergies:{type:Object,required:!1},entriesPerPage:{type:Number,required:!0}},beforeMount(){var e;this.setAllergyPage(1,"known"),this.$props.suspectedAllergies&&this.setAllergyPage(1,"suspected"),this.pages={known:Math.ceil(this.$props.confirmedAllergies.length/this.$props.entriesPerPage),suspected:Math.ceil(((null===(e=this.$props.suspectedAllergies)||void 0===e?void 0:e.length)||0)/this.$props.entriesPerPage)}},watch:{suspectedAllergies(){this.setAllergyPage(-1,"suspected")},confirmedAllergies(){this.setAllergyPage(-1,"known")}},methods:{getAllergyName(e){var t;const l=null===(t=e.code.coding)||void 0===t?void 0:t.find((e=>e.system&&"http://snomed.info/sct"===e.system));if(l&&l.code){const e=N.bt.find((e=>e.defaultCoding.code===l.code));return(null===e||void 0===e?void 0:e.languageDisplays[this.lang])||this.$t("common.unknown")}return this.$t("common.unknown")},setAllergyPage(e,t){const l="known"===t?this.$props.confirmedAllergies:this.$props.suspectedAllergies||[];this.pages[t]=Math.ceil(l.length/this.$props.entriesPerPage),this.currentPage[t]=-1===e?this.pages[t]:e;const a=(this.currentPage[t]-1)*this.$props.entriesPerPage;this.allergies[t]=l.slice(a,a+this.$props.entriesPerPage)}}});var dt=l(7817),ct=l(900);const ut=(0,te.Z)(rt,[["render",it]]),pt=ut;ce()(rt,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QTabs:dt.Z,QTab:ct.Z,QDialog:qe.Z}),ce()(rt,"directives",{ClosePopup:re.Z});const gt=e=>((0,a.dD)("data-v-7653968d"),e=e(),(0,a.Cn)(),e),mt=["onClick"],yt=gt((()=>(0,a._)("hr",{width:"100%"},null,-1))),ht={key:0},wt={key:0,class:"row justify-around full-width"},ft=["onClick"],bt=gt((()=>(0,a._)("hr",null,null,-1))),kt={key:0},Ct={key:0,class:"row justify-start full-width"},Dt=["onClick"],$t={key:0,class:"no-data-text"},vt={class:"day-entry-list"},_t=["onClick"];function At(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-card"),u=(0,a.up)("DiaryEntryCard"),p=(0,a.up)("q-dialog"),g=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"calendar-card dashboard-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-calendar",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("calendar.title")),1)])),_:1}),(0,a.Wm)(d,{class:"row justify-around"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.years,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t.year,class:(0,o.C_)("row justify-evenly year-tile"+(t.expanded?" expanded":""))},[(0,a._)("div",{class:"date",onClick:l=>e.toggleExpanded(t,!t.expanded)},[(0,a._)("h1",null,(0,o.zw)(t.year),1),yt,t.expanded?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",ht,(0,o.zw)(t.numberOfEntries+" "+(1===t.numberOfEntries?e.$t("calendar.entryLabel"):e.$t("calendar.entriesLabel"))),1))],8,mt),t.expanded?((0,a.wg)(),(0,a.iD)("div",wt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.months,(l=>((0,a.wg)(),(0,a.iD)("div",{key:t.year+"/"+l.month,class:(0,o.C_)("month-tile"+(l.expanded?" expanded":""))},[(0,a._)("div",{class:"date",onClick:t=>e.toggleExpanded(l,!l.expanded)},[(0,a._)("h1",null,(0,o.zw)(l.expanded||e.$t("common.month"+l.month).length<=4?e.$t("common.month"+l.month):e.$t("common.month"+l.month).substring(0,3)+"."),1),bt,l.expanded?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("p",kt,(0,o.zw)(l.numberOfEntries+" "+(1===l.numberOfEntries?e.$t("calendar.entryLabel"):e.$t("calendar.entriesLabel"))),1))],8,ft),l.expanded?((0,a.wg)(),(0,a.iD)("div",Ct,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.getDayArray(t.year,l.month),(s=>((0,a.wg)(),(0,a.iD)("div",{key:t.year+"/"+l.month+"/"+s,class:(0,o.C_)("day-entry"+(e.numberOfDayEntries(l.days,Number(s))>0?" with-entries":"")),onClick:()=>e.showDayPopup(l.days.find((e=>e.day.toString()===s)))},(0,o.zw)(s),11,Dt)))),128))])):(0,a.kq)("",!0)],2)))),128))])):(0,a.kq)("",!0)],2)))),128)),0===e.years.length?((0,a.wg)(),(0,a.iD)("p",$t,(0,o.zw)(e.$t("diary.noData")),1)):(0,a.kq)("",!0)])),_:1})])),_:1}),(0,a.Wm)(p,{modelValue:e.dayDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dayDialog=t)},{default:(0,a.w5)((()=>{var l,s,n;return[1===(null===(l=e.selectedDay)||void 0===l?void 0:l.entries.length)?((0,a.wg)(),(0,a.j4)(u,{key:0,entry:null===(s=e.selectedDay)||void 0===s?void 0:s.entries[0],onClose:t[0]||(t[0]=t=>e.dayDialog=!1),onCreatedEntry:()=>{}},null,8,["entry"])):(0,a.kq)("",!0),e.selectedDay&&(null===(n=e.selectedDay)||void 0===n?void 0:n.entries.length)>1?((0,a.wg)(),(0,a.j4)(c,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title with-close-icon"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("calendar.entriesFrom")+" "+new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long"}).format(e.selectedDay.fullDate))+" ",1),(0,a.wy)((0,a.Wm)(r,{onClick:t[1]||(t[1]=t=>e.dayDialog=!1),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[g]])])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("ul",vt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.selectedDay.entries,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:"entry"+l,onClick:()=>{e.subDayDialog=!0,e.subDayEntry=t}},(0,o.zw)(e.$t("calendar.entryTimeLabel1")+new Intl.DateTimeFormat(e.$i18n.locale,{timeStyle:"short"}).format(t.date)+e.$t("calendar.entryTimeLabel2")),9,_t)))),128))])])),_:1})])),_:1})):(0,a.kq)("",!0)]})),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:e.subDayDialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.subDayDialog=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{entry:e.subDayEntry,onClose:t[3]||(t[3]=t=>e.subDayDialog=!1)},null,8,["entry"])])),_:1},8,["modelValue"])],64)}const qt=(0,a.aZ)({name:"CalendarCard",components:{DiaryEntryCard:Se},data(){return{years:new Array,dayDialog:!1,subDayDialog:!1,selectedDay:void 0,subDayEntry:void 0,lang:this.$i18n.locale}},emits:{},props:{diary:{type:Array,required:!0}},mounted(){this.buildDataStructure(this.$props.diary)},methods:{toggleExpanded(e,t){e.expanded=t,!t&&e.hasOwnProperty("months")&&e.months.forEach((e=>{e.expanded&&this.toggleExpanded(e,!1)}))},numberOfDayEntries(e,t){const l=e.findIndex((e=>e.day===t));return-1===l?0:e[l].entries.length},showDayPopup(e){this.selectedDay=e,this.dayDialog=!0},getMonthLength(e,t){return 1===t&&e%4===0&&e%100!==0||e%400===0?29:[31,28,31,30,31,30,31,31,30,31,30,31][t]},getDayOfFirstDay(e,t){const l=new Date(e.toString()+"/"+(t+1).toString()+"/1");return l.getDay()},getDayArray(e,t){const l=this.getDayOfFirstDay(e,t),a=this.getMonthLength(e,t),s=new Array(0===l?6:l-1).map((()=>" "));for(let n=1;n<=a;n++)s.push(n.toString());return s},buildDataStructure(e){this.years=[],e.forEach((e=>{const t=e.date.getFullYear(),l=e.date.getMonth(),a=e.date.getDate(),s={year:t,numberOfEntries:1,expanded:!1,months:[{month:l,numberOfEntries:1,expanded:!1,days:[{day:a,fullDate:new Date(`${t}/${l+1}/${a}`),expanded:!1,entries:[e]}]}]};let n=!1;this.years.forEach((o=>{if(!n&&o.year===t){n=!0;let t=!1;o.months.forEach((n=>{if(!t&&n.month===l){t=!0;let l=!1;n.days.forEach((t=>{l||t.day!==a||(l=!0,t.entries.push(e),n.numberOfEntries++,o.numberOfEntries++)})),l||(n.days.push(s.months[0].days[0]),n.days.sort(((e,t)=>e.day-t.day)),n.numberOfEntries++,o.numberOfEntries++)}})),t||(o.months.push(s.months[0]),o.months.sort(((e,t)=>e.month-t.month)),o.numberOfEntries++)}})),n||(this.years.push(s),this.years.sort(((e,t)=>e.year-t.year)))}))}},watch:{diary(e){this.buildDataStructure(e)}}}),Pt=(0,te.Z)(qt,[["render",At],["__scopeId","data-v-7653968d"]]),St=Pt;function Wt(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("q-select"),u=(0,a.up)("SymptomsTimeline"),p=(0,a.up)("InformationBanner"),g=(0,a.up)("q-card");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(g,{class:"dashboard-card-wide gt-xs"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-chart-line",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("timeline.title")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t),outlined:"",multiple:"","use-chips":"",label:e.$t("timeline.filter"),options:e.availableAllergies,"option-label":t=>t?t.languageDisplays[e.lang]:e.$t("allergy.noAllergy"),dense:"","options-dense":""},null,8,["modelValue","label","options","option-label"])])),_:1}),e.diaryEntries.length>0?((0,a.wg)(),(0,a.j4)(d,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{height:400,range:e.range,"diary-entries":e.diaryEntries},null,8,["range","diary-entries"])])),_:1})):(0,a.kq)("",!0),0===e.diaryEntries.length?((0,a.wg)(),(0,a.j4)(d,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{text:e.$t("diary.noData")},null,8,["text"])])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(g,{class:"dashboard-card lt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-chart-line",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("timeline.title")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{text:e.$t("timeline.noShowText")},null,8,["text"])])),_:1})])),_:1})],64)}ce()(qt,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QDialog:qe.Z}),ce()(qt,"directives",{ClosePopup:re.Z});var Zt=l(3488),xt=l(8313);const Et=(0,a.aZ)({name:"TimelineCard",components:{SymptomsTimeline:xt.Z},props:{diary:{type:Array,required:!0},range:{type:Object,required:!0}},data(){return{lang:(0,J.getLangStringFromLocale)(this.$i18n.locale),diaryEntries:[],filter:new Array,knownAllergyCodes:new Array,suspectedAllergies:new Array,availableAllergies:new Array}},created(){this.availableAllergies=Zt.Z.MergeAllergySystemCodeExtension(Zt.Z.CHAllergyIntoleranceToAllergySystemCodeExtension(this.$store.getKnownAllergies()),this.$store.getSuspectedAllergies(),this.lang),this.filterEntries()},watch:{diary(){this.filterEntries()},range(){this.filterEntries()},filter(){this.filterEntries()}},methods:{filterEntries(){let e=Zt.Z.filterByDate(this.diary,this.range);this.filter.length>0&&(e=e.filter((e=>this.filter.some((t=>{var l;return t.defaultCoding.code===(null===(l=e.allergy)||void 0===l?void 0:l.defaultCoding.code)}))))),this.diaryEntries=e}}}),Vt=(0,te.Z)(Et,[["render",Wt]]),zt=Vt;function Qt(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("AirQualityTimeline"),u=(0,a.up)("q-card"),p=(0,a.up)("WarningBanner"),g=(0,a.up)("InformationBanner");return(0,a.wg)(),(0,a.iD)(a.HY,null,[e.station?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"dashboard-card-wide gt-xs"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-smog",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("airQuality.title"))+" "+(0,o.zw)(e.$t("airQuality.in"))+" "+(0,o.zw)(e.station.languageDisplays[e.lang]),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{height:400,range:e.range,station:e.station,pollen:e.pollen},null,8,["range","station","pollen"])])),_:1})])),_:1})):(0,a.kq)("",!0),e.station?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:1,class:"dashboard-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-smog",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("airQuality.title")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{text:e.$t("airQuality.noStation")},null,8,["text"])])),_:1})])),_:1})),(0,a.Wm)(u,{class:"dashboard-card lt-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-smog",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("airQuality.title")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{text:e.$t("airQuality.noShowText")},null,8,["text"])])),_:1})])),_:1})],64)}ce()(Et,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z,QSelect:ne.Z});var Mt=l(4466);const Ut=(0,a.aZ)({name:"AirQualityTimelineCard",components:{AirQualityTimeline:Mt.Z},props:{station:{type:Object,required:!1},pollen:{type:Object,required:!1},range:{type:Object,required:!0}},data(){return{lang:(0,J.getLangStringFromLocale)(this.$i18n.locale)}}}),Lt=(0,te.Z)(Ut,[["render",Qt]]),jt=Lt;ce()(Ut,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z});const Tt={class:"title"},Ot={class:"subtitle"},It={class:"popup-city"};function Ft(e,t,l,s,n,i){const r=(0,a.up)("q-icon"),d=(0,a.up)("q-card-section"),c=(0,a.up)("mapbox-navigation-control"),u=(0,a.up)("mapbox-popup"),p=(0,a.up)("mapbox-geogeometry-circle"),g=(0,a.up)("mapbox-map"),m=(0,a.up)("q-card"),y=(0,a.up)("WarningBanner");return(0,a.wg)(),(0,a.iD)(a.HY,null,[e.station&&e.pollen?((0,a.wg)(),(0,a.j4)(m,{key:0,class:"dashboard-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>{var t,l;return[(0,a.Wm)(r,{name:"img:pollens/app/"+(null===(l=null===(t=e.selectedPollen)||void 0===t?void 0:t.pollen)||void 0===l?void 0:l.icon)+"@3x.png",class:"big-icon"},null,8,["name"]),(0,a.Uk)(" "+(0,o.zw)(e.pollen.languageDisplays[e.lang]),1)]})),_:1}),(0,a.Wm)(d,{class:"title-container"},{default:(0,a.w5)((()=>[(0,a._)("p",Tt,(0,o.zw)(e.$t("pollen.current_forecast")+e.station.languageDisplays[e.lang]),1),(0,a._)("p",Ot,(0,o.zw)(e.getForecast(e.station,!1)+" ("+e.getPollenLevel(e.station)+" "+e.$t("pollen.unit")+")"),1)])),_:1}),(0,a.Wm)(d,{class:"panel"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{accessToken:e.token,center:[8.2266666666667,46.801111111111],mapStyle:"light-v10",minZoom:6,maxZoom:10,autoResize:!0,interactive:!0,class:"map"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{position:"bottom-left"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$weatherAPIConsumer.getStations(),((t,l)=>((0,a.wg)(),(0,a.j4)(p,{key:l,center:t.lngLat,radius:Math.log2(e.getPollenLevel(t)+2)+5,fillColor:e.getForecast(t,!0),outlineColor:"#000000",opacity:t.id===e.station.id?1:.6},{popup:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a._)("p",It,(0,o.zw)(t.languageDisplays[e.lang]),1),(0,a._)("p",null,(0,o.zw)(e.getForecast(t,!1)+" ("+e.getPollenLevel(t)+" "+e.$t("pollen.unit")+")"),1)])),_:2},1024)])),_:2},1032,["center","radius","fillColor","opacity"])))),128))])),_:1},8,["accessToken"])])),_:1})])),_:1})):(0,a.kq)("",!0),e.station&&e.pollen?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:1,class:"dashboard-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"fas fa-map",class:"big-icon"}),(0,a.Uk)(" "+(0,o.zw)(e.$t("pollen.title")),1)])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[!e.station&&e.pollen?((0,a.wg)(),(0,a.j4)(y,{key:0,text:e.$t("pollen.noStation")},null,8,["text"])):(0,a.kq)("",!0),e.station&&!e.pollen?((0,a.wg)(),(0,a.j4)(y,{key:1,text:e.$t("pollen.noPollen")},null,8,["text"])):(0,a.kq)("",!0),e.station||e.pollen?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(y,{key:2,text:e.$t("pollen.noBoth")},null,8,["text"]))])),_:1})])),_:1}))],64)}var Yt=l(4529),Bt=l(8744);const Ht=(0,a.aZ)({name:"PollenForecast",components:{MapboxMap:Bt.JS,MapboxGeogeometryCircle:Bt.Oj,MapboxPopup:Bt.ls,MapboxNavigationControl:Bt.LA,WarningBanner:Yt.Z},data(){return{lang:(0,J.getLangStringFromLocale)(this.$i18n.locale),token:"pk.eyJ1IjoibWlkYXRhIiwiYSI6ImNqZm4ybzJxajB3d2czNG8wOG5sdjZscjIifQ.tOVOqFTyBm0dqSTuGPw92A",selectedPollen:void 0}},props:{station:{type:Object,required:!1},pollen:{type:Object,required:!1}},created(){this.getSelectedPollen()},updated(){this.getSelectedPollen()},methods:{getSelectedPollen(){var e;(null===(e=this.pollen)||void 0===e?void 0:e.defaultCoding.code)&&(this.selectedPollen=this.$weatherAPIConsumer.getParameter(this.pollen.defaultCoding.code))},getPollenLevel(e){return this.selectedPollen?this.$weatherAPIConsumer.getValue(e.id,this.selectedPollen.defaultCoding.code,this.$today):-1},getForecast(e,t){var l,a;let s=this.getPollenLevel(e),n=null===(a=null===(l=this.selectedPollen)||void 0===l?void 0:l.pollen)||void 0===a?void 0:a.scale;return-1===s||void 0===n?!1===t?this.$t("pollen.no_measurement"):"#fff":s<n.level_1[0]?!1===t?this.$t("pollen.measurement_0"):"#dbdbdb":s>=n.level_1[0]&&s<=n.level_1[1]?!1===t?this.$t("pollen.measurement_1"):"#ff0":s>=n.level_2[0]&&s<=n.level_2[1]?!1===t?this.$t("pollen.measurement_2"):"#ffa500":s>=n.level_3[0]&&s<=n.level_3[1]?!1===t?this.$t("pollen.measurement_3"):"#f00":!1===t?this.$t("pollen.measurement_4"):"#760000"}}}),Nt=(0,te.Z)(Ht,[["render",Ft],["__scopeId","data-v-26d4bb22"]]),Kt=Nt;ce()(Ht,"components",{QCard:le.Z,QCardSection:ae.Z,QIcon:se.Z});const Rt={class:"text-h6"},Xt={class:"text-subtitle1"},Gt={class:"text-subtitle1 q-mt-sm"},Jt={class:"text-subtitle1 q-mt-sm"},el={class:"text-subtitle1 q-mt-sm"};function tl(e,t,l,s,n,i){const r=(0,a.up)("q-option-group"),d=(0,a.up)("q-select"),c=(0,a.up)("DashboardSettings"),u=(0,a.up)("q-banner"),p=(0,a.up)("q-popup-proxy"),g=(0,a.up)("q-btn"),m=(0,a.up)("q-page-sticky");return(0,a.wg)(),(0,a.j4)(m,{position:"bottom-right",offset:[18,18],class:"fab-container"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{fab:"",icon:"fas fa-cog",color:"accent"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{offset:[0,10]},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"q-mx-sm"},{default:(0,a.w5)((()=>[(0,a._)("div",Rt,(0,o.zw)(e.$t("dashboardFAB.title")),1),(0,a._)("div",Xt,(0,o.zw)(e.$t("dashboardFAB.entriesText")),1),(0,a.Wm)(r,{modelValue:e.offset,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.offset=t),e.offsetChanged],options:[{label:e.$t("dashboardFAB.allEntries"),value:365},{label:e.$t("dashboardFAB.last30days"),value:30},{label:e.$t("dashboardFAB.last7days"),value:7}]},null,8,["modelValue","options","onUpdate:modelValue"]),(0,a._)("div",Gt,(0,o.zw)(e.$t("dashboardFAB.stationText")),1),(0,a.Wm)(d,{modelValue:e.station,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.station=t),e.stationChanged],options:e.$weatherAPIConsumer.getStations(),"option-label":t=>t.languageDisplays[e.lang]},null,8,["modelValue","options","option-label","onUpdate:modelValue"]),(0,a._)("div",Jt,(0,o.zw)(e.$t("dashboardFAB.pollenText")),1),(0,a.Wm)(d,{modelValue:e.pollen,"onUpdate:modelValue":[t[2]||(t[2]=t=>e.pollen=t),e.pollenChanged],options:e.availablePollens,"option-label":t=>t.languageDisplays[e.lang],disable:0===e.availablePollens.length},null,8,["modelValue","options","option-label","onUpdate:modelValue","disable"]),(0,a._)("div",el,(0,o.zw)(e.$t("dashboardFAB.componentsText")),1),(0,a.Wm)(c,{onDashboardSettingsChanged:t[3]||(t[3]=t=>e.$emit("dashboardSettingsChanged"))})])),_:1})])),_:1})])),_:1})])),_:1})}var ll=l(7780);const al=(0,a.aZ)({name:"DashboardFAB",components:{DashboardSettings:ll.Z},data(){return{lang:(0,J.getLangStringFromLocale)(this.$i18n.locale),offset:this.$store.getDaysDisplayedOnDashboard(),station:this.$store.getStation(),pollen:this.$store.getPollen(),availablePollens:[]}},created(){this.availablePollens=Zt.Z.MergeAllergySystemCodeExtension(Zt.Z.CHAllergyIntoleranceToAllergySystemCodeExtension(this.$store.getKnownAllergies()),this.$store.getSuspectedAllergies(),this.lang).filter((e=>this.$weatherAPIConsumer.getParamaters().some((t=>t.defaultCoding.code===e.defaultCoding.code))))},methods:{offsetChanged(e){this.$store.setDaysDisplayedOnDashboard(e),this.$emit("offsetChanged")},stationChanged(e){this.$store.setStation(e),this.$emit("stationChanged")},pollenChanged(e){this.$store.setPollen(e),this.$emit("pollenChanged")}}});var sl=l(627),nl=l(2765),ol=l(8001),il=l(5261);const rl=(0,te.Z)(al,[["render",tl],["__scopeId","data-v-4bd18143"]]),dl=rl;ce()(al,"components",{QPageSticky:sl.Z,QBtn:ie.Z,QPopupProxy:nl.Z,QBanner:ol.Z,QOptionGroup:il.Z,QSelect:ne.Z});var cl=l(4170);const ul=(0,a.aZ)({name:"DashboardPage",components:{DiaryEntryCard:Se,DiaryListCard:Fe,CalendarCard:St,TimelineCard:zt,AllergyCard:pt,PollenMapCard:Kt,DashboardFAB:dl,AirQualityTimelineCard:jt},data(){return{diary:[...this.$store.getDiary()],displayEntry:void 0,diaryDialog:!1,showDiaryListCard:!1,showCalendarCard:!1,showNewEntryCard:!1,showTimelineCard:!1,showAllergyCard:!1,showPollenMap:!1,showAirQualityCard:!1,pollen:this.$store.getPollen(),station:this.$store.getStation(),offset:this.$store.getDaysDisplayedOnDashboard(),range:{from:cl.ZP.subtractFromDate(this.$today,{days:this.$store.getDaysDisplayedOnDashboard()-1}).getTime(),to:this.$today.getTime()}}},created(){this.dashboardSettingsChanged()},mounted(){},methods:{showEntry(e){this.displayEntry=e,this.diaryDialog=!0},createEntry(e){this.diary=[...this.$store.addDiaryEntry(e)]},offsetChanged(){this.range={from:cl.ZP.subtractFromDate(this.$today,{days:this.$store.getDaysDisplayedOnDashboard()-1}).getTime(),to:this.$today.getTime()}},stationChanged(){this.station=this.$store.getStation()},pollenChanged(){this.pollen=this.$store.getPollen()},dashboardSettingsChanged(){this.showDiaryListCard=this.$store.getSettings().dashboard.includes(K.MX.DIARY_LIST),this.showCalendarCard=this.$store.getSettings().dashboard.includes(K.MX.CALENDAR),this.showNewEntryCard=this.$store.getSettings().dashboard.includes(K.MX.NEW_DIARY_ENTRY),this.showTimelineCard=this.$store.getSettings().dashboard.includes(K.MX.TIMELINE),this.showAllergyCard=this.$store.getSettings().dashboard.includes(K.MX.ALLERGIES),this.showPollenMap=this.$store.getSettings().dashboard.includes(K.MX.POLLEN_MAP),this.showAirQualityCard=this.$store.getSettings().dashboard.includes(K.MX.AIR_QUALITY)}}}),pl=(0,te.Z)(ul,[["render",n]]),gl=pl;ce()(ul,"components",{QDialog:qe.Z})}}]);
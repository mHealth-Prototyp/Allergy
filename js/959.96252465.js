"use strict";(globalThis["webpackChunkmhealth_proto_patient"]=globalThis["webpackChunkmhealth_proto_patient"]||[]).push([[959],{8569:(e,t,i)=>{i.r(t),i.d(t,{default:()=>G});var o=i(9835),n=i(6970);function l(e,t,i,l,a,s){const r=(0,o.up)("q-card-section"),d=(0,o.up)("DocumentUpload"),c=(0,o.up)("q-card"),u=(0,o.up)("FhirExportCard");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(c,{class:"about-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{class:"card-title"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.$t("documents.title")),1)])),_:1}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{patient:e.$store.getPatient(),onDone:e.onUploaded,fhirUtils:e.$fhirUtils,languageString:e.lang,epdPlaygroundUtils:e.$epdUtils,settings:e.$store.getSettings()},null,8,["patient","onDone","fhirUtils","languageString","epdPlaygroundUtils","settings"])])),_:1})])),_:1}),(0,o.Wm)(u,{onDone:e.onUploaded},null,8,["onDone"])],64)}var a=i(3102);const s={class:"row items-center justify-end"};function r(e,t,i,l,a,r){const d=(0,o.up)("SymptomsTimeline"),c=(0,o.up)("q-card-section"),u=(0,o.up)("AirQualityTimeline"),p=(0,o.up)("q-card"),h=(0,o.up)("q-btn"),m=(0,o.up)("q-date"),g=(0,o.up)("q-popup-proxy"),f=(0,o.up)("q-icon"),y=(0,o.up)("q-input"),v=(0,o.up)("q-card-actions"),$=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(p,{class:"hidden-charts"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{height:400,range:e.timestampRange,"diary-entries":e.diary},null,8,["range","diary-entries"])])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{height:400,range:e.timestampRange,station:e.$store.getStation(),pollen:e.$store.getPollen()},null,8,["range","station","pollen"])])),_:1})])),_:1}),(0,o.Wm)(p,{class:"dashboard-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"card-title"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.$t("export.title")),1)])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"q-mb-md",modelValue:e.rangeDisplay,"onUpdate:modelValue":t[1]||(t[1]=t=>e.rangeDisplay=t),outlined:"",label:e.$t("export.text"),readonly:""},{append:(0,o.w5)((()=>[(0,o.Wm)(f,{name:"fas fa-calendar-week",color:"primary",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:e.range,"onUpdate:modelValue":t[0]||(t[0]=t=>e.range=t),range:"",mask:"x",options:e.dateSelectorOptions},{default:(0,o.w5)((()=>[(0,o._)("div",s,[(0,o.wy)((0,o.Wm)(h,{label:e.$t("common.close"),color:"primary",flat:""},null,8,["label"]),[[$]])])])),_:1},8,["modelValue","options"])])),_:1})])),_:1})])),_:1},8,["modelValue","label"]),(0,o.Wm)(y,{class:"q-mb-md",modelValue:e.fileName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.fileName=t),outlined:"",type:"text",label:e.$t("export.filename")},null,8,["modelValue","label"]),(0,o.Wm)(y,{modelValue:e.fileDescription,"onUpdate:modelValue":t[3]||(t[3]=t=>e.fileDescription=t),outlined:"",type:"textarea",label:e.$t("export.description")},null,8,["modelValue","label"])])),_:1}),(0,o.Wm)(v,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{onClick:e.submit,color:"primary",label:e.$t("export.export"),disable:null===e.range||""===e.fileDescription},null,8,["onClick","label","disable"])])),_:1})])),_:1})],64)}var d=i(4170),c=i(796),u=i(4095),p=i(865),h=i(3488);class m{constructor(e,...t){this.resourceType="Bundle",this.meta={profile:["http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-document-epr"]},this.identifier={system:"urn:ietf:rfc:3986"},this.type=u.BundleType.DOCUMENT,this.entry=[];const i=(new Date).toISOString();this.meta.lastUpdated=i,this.identifier.value="urn:uuid:"+(0,c.Z)(),this.timestamp=i,this.entry[0]={fullUrl:this.getFullUrl(e.id,e.resourceType),resource:e},this.addResource(...t)}addResource(...e){for(const t of e)t.resourceType&&t.id&&this.entry.push({fullUrl:this.getFullUrl(t.id,t.resourceType),resource:t})}getFullUrl(e,t){return h.Z.isUUID(e)?`urn:uuid:${e}`:`${p.V.BASE_URL}${t}/${e}`}}var g=i(8958);function f(e){const t=(0,g.fragment)({encoding:"UTF-8",defaultNamespace:{ele:"http://www.w3.org/1999/xhtml"}},"div").first();return e&&t.ele("h1").txt(e),t}function y(e,t){const i={dt:{strong:{"#":e}},dd:{"#":t}};return i}function v(e){return{status:u.NarrativeStatus.GENERATED,div:e.end({prettyPrint:!1})}}function $(e,t){var i,o,n;const l=f(t("fhirPatient.resourceType"));e.id&&l.ele("p").ele("a",{href:`${p.V.BASE_URL}Patient/${e.id}`}).txt(`${p.V.BASE_URL}Patient/${e.id}`),l.ele("p").ele("a",{href:"http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient-epr"}).txt("CH Core Patient Profile EPR");const a=l.ele("dl");if(e.name&&e.name.length>0){const n=null!==(i=e.name.find((e=>e.use===u.HumanNameNameUse.OFFICIAL)))&&void 0!==i?i:e.name[0];let l="";for(const e of null!==(o=n.given)&&void 0!==o?o:[])l+=`${e} `;n.family&&(l+=n.family),a.ele(y(t("fhirPatient.name"),l.trim()))}if(e.gender&&a.ele(y(t("common.gender"),t(`common.${e.gender}`))),e.birthDate&&a.ele(y(t("common.birthdate"),d.ZP.formatDate(e.birthDate,"DD.MM.YYYY"))),e.address&&e.address.length>0){const i=null!==(n=e.address.find((e=>e.use===u.AddressUse.HOME)))&&void 0!==n?n:e.address[0];if(i.line&&i.postalCode&&i.city){a.ele("dt").ele("strong").txt(t("common.address"));for(const e of i.line)a.ele("dd").txt(e);a.ele("dd").txt(`${i.postalCode}, ${i.city}`),i.state&&a.ele("dd").txt(i.state),i.country&&a.ele("dd").txt(i.country)}}return v(l)}function D(e,t){var i;const o=f(e.title);o.ele("p").txt(`urn:uuid:${e.id}`),o.ele("p").ele("a",{href:e.meta.profile}).txt("CH Core Composition Profile EPR");const n=o.ele("dl");n.ele(y(t("fhirComposition.status"),t("fhirComposition.compositionStatus."+e.status)));const l=null===(i=e.type.coding)||void 0===i?void 0:i.at(0);return(null===l||void 0===l?void 0:l.display)&&n.ele(y(t("common.type"),l.display)),n.ele(y(t("common.date"),`${d.ZP.formatDate(e.date,"DD.MM.YYYY HH:mm")}`)),e.subject.reference&&(n.ele("dt").ele("strong").txt(t("fhirComposition.subject")),n.ele("dd").ele("a",{href:p.V.BASE_URL+e.subject.reference}).txt(`${e.subject.reference}`)),v(o)}function x(e,t){var i,o,n,l,a,s,r,d,c,u;const p=f();p.ele("p").ele("a",{href:"http://fhir.ch/ig/ch-allergyintolerance/StructureDefinition/ch-allergyintolerance"}).txt("CH Allergy Intolerance");const h=p.ele("dl"),m=null===(o=null===(i=e.clinicalStatus)||void 0===i?void 0:i.coding)||void 0===o?void 0:o.at(0);(null===m||void 0===m?void 0:m.display)&&h.ele(y(t("fhirAllergyIntolerance.clinicalStatus"),t("fhirAllergyIntolerance.allergyIntoleranceClinicalStatus."+m.display.toLowerCase())));const g=null===(l=null===(n=e.verificationStatus)||void 0===n?void 0:n.coding)||void 0===l?void 0:l.at(0);if((null===g||void 0===g?void 0:g.display)&&h.ele(y(t("fhirAllergyIntolerance.verificationStatus"),t("fhirAllergyIntolerance.allergyIntoleranceVerificationStatus."+g.display.toLowerCase()))),e.type&&h.ele(y(t("fhirAllergyIntolerance.type"),t("fhirAllergyIntolerance.allergyIntoleranceType."+e.type))),e.category){let i="";e.category.forEach((e=>i+=t("fhirAllergyIntolerance.allergyIntoleranceCategory."+e)+", ")),h.ele(y(t("fhirAllergyIntolerance.category"),i.slice(0,-2)))}if(e.criticality&&h.ele(y(t("fhirAllergyIntolerance.criticality"),t("fhirAllergyIntolerance.allergyIntoleranceCriticality."+e.criticality))),(null===(a=e.code)||void 0===a?void 0:a.coding)&&h.ele(y(t("fhirAllergyIntolerance.code"),null!==(s=e.code.coding[0].display)&&void 0!==s?s:"")),e.reaction&&e.reaction.length>0){const i=p.ele("h4").txt(t("fhirAllergyIntolerance.reactions")).up().ele("table");i.ele("thead").ele("tr",{style:"text-align: center;"}).ele("th").txt(t("fhirAllergyIntolerance.substance")).up().ele("th").txt(t("fhirAllergyIntolerance.manifestation")).up().ele("th").txt(t("fhirAllergyIntolerance.severity")).up().ele("th").txt(t("fhirAllergyIntolerance.exposureRoute"));const o=i.ele("tbody");for(const t of e.reaction){const e=o.ele("tr",{style:"text-align: center;"}),i=null===(d=null===(r=t.substance)||void 0===r?void 0:r.coding)||void 0===d?void 0:d.at(0);if((null===i||void 0===i?void 0:i.display)?e.ele("td").txt(i.display):e.ele("td").txt("-"),t.manifestation&&t.manifestation.length>0){const i=[];t.manifestation.forEach((e=>{var t;return i.push(...null!==(t=e.coding)&&void 0!==t?t:[])}));let o="";i.forEach((e=>o+=e.display?e.display+" ,":"")),e.ele("td").txt(o.slice(0,-2))}else e.ele("td").txt("-");t.severity?e.ele("td").txt(t.severity):e.ele("td").txt("-");const n=null===(u=null===(c=t.exposureRoute)||void 0===c?void 0:c.coding)||void 0===u?void 0:u.at(0);(null===n||void 0===n?void 0:n.display)?e.ele("td").txt(n.display):e.ele("td").txt("-")}}return v(p)}class S{constructor(e,t,i,o,n,l,a){var s,r;this.meta={profile:["http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-composition-epr"]},this.extension=[],this.identifier={system:"urn:ietf:rfc:3986"},this.status=u.CompositionStatus.PRELIMINARY,this.type={coding:[]},this.subject={},this.author=[],this.resourceType="Composition",this.id=(0,c.Z)();const d=(new Date).toISOString();this.meta.lastUpdated=d,this.language=e,this.identifier.value="urn:uuid:"+(0,c.Z)(),null===(s=this.type.coding)||void 0===s||s.push(t),this.subject.reference=`Patient/${null!==(r=i.id)&&void 0!==r?r:""}`,this.date=d;for(const c of o)if(c.resourceType&&c.id){const e=this.getReference(c.id,c.resourceType);this.author.push({reference:e}),this.extension.push({url:"http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-informationrecipient",valueReference:{reference:e}})}this.title=n,this.confidentiality=l,this.section=[],this._confidentiality={extension:[{url:"http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-confidentialitycode",valueCodeableConcept:{coding:[a]}}]}}addSectionWithImage(e,t,...i){var o;const n={title:e,entry:[]},l=f();l.ele("h2").txt(e),l.ele("div").ele("h4").txt(t.title).up().ele("img",{src:t.src});for(const[a,s]of i.entries())if(s.resourceType&&s.id){const e=this.getReference(s.id,s.resourceType);null===(o=n.entry)||void 0===o||o.push({reference:this.getReference(s.id,s.resourceType)});const t=s.text;(null===t||void 0===t?void 0:t.div)&&(l.ele("h3").txt(`Entry ${a.toString()}`),h.Z.isUUID(s.id)?l.ele("p").txt(e):l.ele("a",{href:`${p.V.BASE_URL}${s.resourceType}/${s.id}`}).txt(e),l.ele((0,g.convert)(null===t||void 0===t?void 0:t.div,{format:"object"})))}n.text=v(l),this.section.push(n)}addSection(e,...t){var i;const o={title:e,entry:[]},n=f();n.ele("h2").txt(e);for(const[l,a]of t.entries())if(a.resourceType&&a.id){const e=this.getReference(a.id,a.resourceType);null===(i=o.entry)||void 0===i||i.push({reference:this.getReference(a.id,a.resourceType)});const t=a.text;(null===t||void 0===t?void 0:t.div)&&(n.ele("h3").txt(`Entry ${l.toString()}`),h.Z.isUUID(a.id)?n.ele("p").txt(e):n.ele("a",{href:`${p.V.BASE_URL}${a.resourceType}/${a.id}`}).txt(e),n.ele((0,g.convert)(null===t||void 0===t?void 0:t.div,{format:"object"})))}o.text=v(n),this.section.push(o)}getReference(e,t){return h.Z.isUUID(e)?`urn:uuid:${e}`:`${t}/${e}`}}class w{constructor(e,...t){var i;this.status=u.ObservationStatus.PRELIMINARY,this.code={coding:[]},this.resourceType="Observation",this.id=(0,c.Z)(),null===(i=this.code.coding)||void 0===i||i.push(e),this.addComponent(...t)}addComponent(...e){e.length>0&&(this.component||(this.component=[]),e.forEach((e=>{var t;return null===(t=this.component)||void 0===t?void 0:t.push(e)})))}}class b{constructor(e){var t;this.code={coding:[]},null===(t=this.code.coding)||void 0===t||t.push(e)}}var A=i(7861),C=i(112),I=i(4276),R=i(2001);const T={system:"http://snomed.info/sct",code:"184216000",display:"Patient record type"},U="mHealth Proto Allergy Export",P={system:"http://snomed.info/sct",code:"419891008",display:"Record artifact (record artifact)"},Y=(0,o.aZ)({data(){var e;return{lang:(0,A.getLangStringFromLocale)(this.$i18n.locale),patient:this.$store.getPatient(),patientReference:{reference:`Patient/${null!==(e=this.$store.getPatient().id)&&void 0!==e?e:""}`},organization:this.$store.getSettings().organization,date:Date.now(),range:null,timestampRange:{from:0,to:0},rangeDisplay:"",knownAllergies:[],suspectedAllergies:[],diary:[],fileName:"",fileDescription:""}},props:{onDone:{type:Function,required:!0}},watch:{range(e){if(e){let t,i;"string"===typeof e?(t=new Date(Number.parseInt(e)),i=new Date(Number.parseInt(e))):(t=new Date(Number.parseInt(e.from)),i=new Date(Number.parseInt(e.to))),this.timestampRange={from:Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),to:Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())},this.rangeDisplay=d.ZP.formatDate(this.timestampRange.from,"DD.MM.YYYY")+" - "+d.ZP.formatDate(this.timestampRange.to,"DD.MM.YYYY")}else this.timestampRange={from:0,to:0},this.rangeDisplay=""},timestampRange(e){0!==e.from&&0!==e.to?(this.knownAllergies=this.$store.getKnownAllergies(),this.suspectedAllergies=this.$store.getSuspectedAllergiesAsFhir(),this.diary=this.$store.getDiary().filter((t=>d.ZP.isBetweenDates(t.date,e.from,e.to,{onlyDate:!0,inclusiveFrom:!0,inclusiveTo:!0})))):this.diary=[]}},methods:{submit(){var e,t;const i=e=>this.$t(e);this.patient.text=$(this.patient,i);const o=new S(this.lang,P,this.patient,[this.patient,this.$store.getSettings().organization],`${this.$t("export.compositionTitle")} ${d.ZP.formatDate(null===(e=this.timestampRange)||void 0===e?void 0:e.from,"DD.MM.YYYY")} ${this.$t("export.to")} ${d.ZP.formatDate(null===(t=this.timestampRange)||void 0===t?void 0:t.to,"DD.MM.YYYY")}`,"N",{system:"http://snomed.info/sct",code:"263856008",display:"Restricted (qualifier value)"});o.category=[{coding:[T]}];const n=new m(o,this.patient,this.organization);for(const s of this.knownAllergies)s.text=x(s,i);o.addSection(this.$t("export.knownAllergies"),...this.knownAllergies);for(const s of this.suspectedAllergies)s.text=x(s,i);o.addSection(this.$t("export.suspectedAllergies"),...this.suspectedAllergies);const l=this.diaryToFhir();o.addSectionWithImage(this.$t("export.diaryEntries"),{title:this.$t("timeline.chartTitle"),src:this.symptomsTimelineSVG()},...l);const a=this.measurementsToFhir();a?(o.addSection(this.$t("export.airQualityData"),a),n.addResource(...this.knownAllergies,...this.suspectedAllergies,...l,a)):n.addResource(...this.knownAllergies,...this.suspectedAllergies,...l),o.status=u.CompositionStatus.FINAL,o.text=D(o,i),this.upload(n)},diaryToFhir(){var e,t,i,o,n;const l=[],a={260413007:"None (Qualifier value)",255604002:"Mild (Qualifier value)",6736007:"Moderate (severity modifier) (qualifier value)",24484e3:"Severe (severity modifier) (qualifier value)"};for(const s of this.diary){const r=f(),p=r.ele("dl"),h=new w({system:"http://loinc.org",code:"51855-5",display:"Patient Note"});h.subject=this.patientReference,h.effectiveDateTime=s.date.toISOString(),p.ele(y(this.$t("common.date"),d.ZP.formatDate(s.date,"DD.MM.YYYY HH:mm"))),null===(e=h.performer)||void 0===e||e.push(this.patientReference),s.note?(h.valueString=s.note,p.ele(y(this.$t("diary.noteLabel"),s.note))):(h.dataAbsentReason={coding:[{system:"http://terminology.hl7.org/CodeSystem/data-absent-reason",code:"asked-declined",display:"Asked But Declined"}]},p.ele(y(this.$t("export.dataAbsentReasonLabel"),this.$t("export.asked-declined"))));const m=p.ele("dt").ele("strong").txt(this.$t("symptom.location")).up().ele("dd").ele("dl");for(const e of s.symptoms){const t=new b(e.location.defaultCoding);t.valueCodeableConcept={coding:[{system:"http://snomed.info/sct",code:e.intensity,display:a[e.intensity]}]},m.ele(y(this.$t(`symptom.${e.location.name}`),this.$t(`symptom.${e.intensity}`))),h.addComponent(t)}if(s.allergy){const e=new b({system:"http://loinc.org",code:"52473-6",display:"Allergy or cause of reaction"});e.valueCodeableConcept={coding:[s.allergy.defaultCoding]},p.ele(y(this.$t("export.concernedAllergy"),s.allergy.languageDisplays[this.lang])),h.addComponent(e)}if(s.medications&&s.medications.length>0){p.ele("dt").ele("strong").txt(this.$t("export.medicationTaken"));for(const e of s.medications){let l="";(null===(t=e.code)||void 0===t?void 0:t._text)?l=null!==(i=(0,u.readI18N)(e.code._text,this.lang))&&void 0!==i?i:l:(null===(o=e.code)||void 0===o?void 0:o.text)&&(l=null!==(n=e.code.text)&&void 0!==n?n:l),p.ele("dd").txt(l);const a=new b({system:"http://loinc.org",code:"18816-9",display:"Medication name + identifier"});a.valueCodeableConcept=e.code,h.addComponent(a)}}h.id=(0,c.Z)(),h.status=u.ObservationStatus.FINAL,h.text=v(r),l.push(h)}return l},measurementsToFhir(){var e,t,i,o,n,l,a,s,r,p,h,m,g,v,$,D,x,S,A,C,I,R,T,U;const P=[],Y=this.$store.getStation();if(Y){const Z={resourceType:"Location",language:this.lang,id:Y.id,identifier:[{system:"https://www.meteoswiss.admin.ch/services-and-publications/applications/measurement-values-and-measuring-networks.html",value:Y.id}],name:Y.languageDisplays[this.lang],position:{longitude:Y.lngLat[0],latitude:Y.lngLat[1]}};this.$weatherAPIConsumer.getParamaters().forEach((e=>{const t=new b(e.defaultCoding);t.valueSampledData={origin:{value:0,unit:e.unit.unit,system:e.unit.system,code:e.unit.code},period:864e5,dimensions:1,data:""},Y&&this.timestampRange&&(t.valueSampledData.data="",this.$weatherAPIConsumer.getValues(Y.id,e.defaultCoding.code,new Date(this.timestampRange.from),new Date(this.timestampRange.to)).forEach((e=>{t.valueSampledData&&(t.valueSampledData.data+=`${-1===e[1]?"E":e[1]} `)}))),P.push(t)}));for(const t of P)t.valueSampledData&&(t.valueSampledData.data=null===(e=t.valueSampledData.data)||void 0===e?void 0:e.trimEnd());const E={system:"http://airquality.placeholder.test.ch/items",code:"airquality",display:"Air Quality"},_=new w(E,...P);_.contained=[Z],_.subject={reference:`#${null!==(t=Z.id)&&void 0!==t?t:""}`,type:"Location",display:Z.name},this.timestampRange&&(_.effectivePeriod={start:new Date(this.timestampRange.from).toISOString(),end:new Date(this.timestampRange.to).toISOString()}),_.id=(0,c.Z)(),_.status=u.ObservationStatus.FINAL;const M=f();M.ele("div").ele("h4").txt(this.$t("airQuality.title")).up().ele("img",{src:this.AirQualityTimelineSVG()});const N=M.ele("dl");N.ele(y(this.$t("export.station"),null!==(i=Z.name)&&void 0!==i?i:"")),N.ele(y(this.$t("export.short"),null!==(n=null===(o=Z.identifier)||void 0===o?void 0:o[0].value)&&void 0!==n?n:"")),N.ele(y(this.$t("export.lngLat"),`${null!==(a=null===(l=Z.position)||void 0===l?void 0:l.longitude)&&void 0!==a?a:""} / ${null!==(r=null===(s=Z.position)||void 0===s?void 0:s.latitude)&&void 0!==r?r:""}`));const L=M.ele("table"),F=L.ele("thead").ele("tr");F.ele("th").ele("b").txt(this.$t("common.date"));const V=[];for(const e of P){const t=null!==(m=null===(h=null===(p=e.code.coding)||void 0===p?void 0:p.at(0))||void 0===h?void 0:h.display)&&void 0!==m?m:"",i=null!==($=null===(v=null===(g=e.valueSampledData)||void 0===g?void 0:g.origin)||void 0===v?void 0:v.code)&&void 0!==$?$:"";F.ele("th").ele("b").txt(`${t} [${i}]`),V.push(null!==(S=null===(x=null===(D=e.valueSampledData)||void 0===D?void 0:D.data)||void 0===x?void 0:x.split(" "))&&void 0!==S?S:[])}const W=L.ele("tbody");for(let e=0;e<=d.ZP.getDateDiff(null!==(C=null===(A=this.timestampRange)||void 0===A?void 0:A.to)&&void 0!==C?C:0,null!==(R=null===(I=this.timestampRange)||void 0===I?void 0:I.from)&&void 0!==R?R:0);e++){const t=W.ele("tr");t.ele("td").txt(d.ZP.formatDate(d.ZP.addToDate(null!==(U=null===(T=this.timestampRange)||void 0===T?void 0:T.from)&&void 0!==U?U:0,{days:e}),"DD.MM.YYYY"));for(const i of V)t.ele("td").txt(i[e])}return _.text={status:u.NarrativeStatus.GENERATED,div:M.end({headless:!0,prettyPrint:!1})},_}return null},dateSelectorOptions(e){return e<=`${this.$today.getFullYear()}/${`0${this.$today.getMonth()+1}`.slice(-2)}/${`0${this.$today.getDate()}`.slice(-2)}`},symptomsTimelineSVG(){var e,t,i;const o=null!==(i=null===(t=null===(e=document.getElementById("apexchartssymptoms-timeline"))||void 0===e?void 0:e.firstElementChild)||void 0===t?void 0:t.outerHTML)&&void 0!==i?i:"";return`data:image/svg+xml;base64,${I.DS.encode(o)}`},AirQualityTimelineSVG(){var e,t,i;const o=null!==(i=null===(t=null===(e=document.getElementById("apexchartsair-quality-timeline"))||void 0===e?void 0:e.firstElementChild)||void 0===t?void 0:t.outerHTML)&&void 0!==i?i:"";return`data:image/svg+xml;base64,${I.DS.encode(o)}`},upload(e){const t={title:this.fileName,isFhir:!0,description:this.fileDescription,contentLanguage:this.lang,sourceIdentifier:this.$store.getOids().app,categoryCoding:T,typeCoding:P,facilityCoding:{system:"http://snomed.info/sct",code:"394778007",display:"Client's or patient's home (environment)"},practiceSettingCoding:this.$store.getSettings().practiceSetting,authorRole:a.HO.PAT};this.$fhirUtils.createIti65Bundle(this.patient,new File([JSON.stringify(e)],this.fileName+".json",{type:"application/fhir+json"}),t).then((e=>{var t;const i=null===(t=e.entry.find((e=>"DocumentReference"===e.resource.resourceType)))||void 0===t?void 0:t.resource;return i.content&&i.content[0]&&i.content[0].attachment&&(i.content[0].attachment.title=U),this.$epdUtils.useITI65(e)})).then(this.onDone).catch((e=>{console.error(e),this.onDone()}))}},components:{SymptomsTimeline:C.Z,AirQualityTimeline:R.Z}});var Z=i(1639),E=i(4458),_=i(3190),M=i(3119),N=i(2857),L=i(2765),F=i(4351),V=i(4455),W=i(1821),k=i(2146),Q=i(9984),q=i.n(Q);const O=(0,Z.Z)(Y,[["render",r],["__scopeId","data-v-52cedd12"]]),H=O;q()(Y,"components",{QCard:E.Z,QCardSection:_.Z,QInput:M.Z,QIcon:N.Z,QPopupProxy:L.Z,QDate:F.Z,QBtn:V.Z,QCardActions:W.Z}),q()(Y,"directives",{ClosePopup:k.Z});var B=i(4328);const j=(0,o.aZ)({name:"Upload-Page",components:{DocumentUpload:a.SD,FhirExportCard:H},data(){return{lang:this.$store.getSettings().language.substring(0,2)}},methods:{onUploaded(e){e?this.$router.push("documents").then((()=>null)).catch((e=>console.log(e))):B.Z.create({message:this.$t("common.error"),color:"primary"})}}}),z=(0,Z.Z)(j,[["render",l],["__scopeId","data-v-2473a39d"]]),G=z;q()(j,"components",{QCard:E.Z,QCardSection:_.Z})}}]);
"use strict";(globalThis["webpackChunkmhealth_proto_patient"]=globalThis["webpackChunkmhealth_proto_patient"]||[]).push([[250],{250:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var l=n(9835),o=n(6970);function a(e,t,n,a,i,u){const d=(0,l.up)("q-card-section"),s=(0,l.up)("DocumentSearch"),c=(0,l.up)("q-card"),r=(0,l.up)("q-icon"),p=(0,l.up)("AllergyView"),m=(0,l.up)("q-dialog"),g=(0,l.up)("DocumentView"),h=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("documents.title")),1)])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{patient:e.$store.getPatient(),ref:"documentSearch",locale:e.$store.getSettings().language,demoMode:!1,addedDocuments:e.uploadedDocuments,onFoundDocument:e.openDocument,fhirUtils:e.$fhirUtils,languageString:e.lang,epdPlaygroundUtils:e.$epdUtils},null,8,["patient","locale","addedDocuments","onFoundDocument","fhirUtils","languageString","epdPlaygroundUtils"])])),_:1})])),_:1}),(0,l.Wm)(m,{modelValue:e.showAllergyPopup,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showAllergyPopup=t),class:"dialog"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"allergy-dialog-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title with-close-icon"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.allergyToDisplay?e.getAllergyName(e.allergyToDisplay):"")+" ",1),(0,l.wy)((0,l.Wm)(r,{onClick:t[0]||(t[0]=()=>{e.showAllergyPopup=!1,e.allergyToDisplay=void 0}),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[h]])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{allergyIntolerance:e.allergyToDisplay,languageString:e.lang,fhirUtils:e.$fhirUtils,epdPlaygroundUtils:e.$epdUtils,showTitle:!1},null,8,["allergyIntolerance","languageString","fhirUtils","epdPlaygroundUtils"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(m,{modelValue:e.showDocumentBundlePopup,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showDocumentBundlePopup=t),class:"dialog"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"document-dialog-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title with-close-icon"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("documents.documentViewTitle"))+" ",1),(0,l.wy)((0,l.Wm)(r,{onClick:t[2]||(t[2]=()=>{e.showDocumentBundlePopup=!1,e.documentBundleToDisplay=void 0}),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[h]])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{document:e.documentBundleToDisplay,languageString:e.lang,ratio:e.$q.screen.gt.xs?16/9:9/16},null,8,["document","languageString","ratio"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var i=n(4095),u=n(3102);const d=(0,l.aZ)({name:"Documents-Page",components:{DocumentSearch:u.jS,AllergyView:u.HY,DocumentView:u.sg},data(){return{uploadedDocuments:new Array,lang:this.$i18n.locale.substring(0,2),showAllergyPopup:!1,allergyToDisplay:void 0,showDocumentBundlePopup:!1,documentBundleToDisplay:void 0}},methods:{openDocument(e){const t=e.document,n=e.metadata,l=JSON.parse(t);this.checkIfIsAllergy(n)?(this.showAllergyPopup=!0,this.allergyToDisplay=l):this.checkIfIsDocumentBundle(l)?(this.showDocumentBundlePopup=!0,this.documentBundleToDisplay=JSON.parse(t)):confirm(this.$t("documents.openPrompt1")+(n.description||this.$t("documents.unknownTitle"))+this.$t("documents.openPrompt2"))&&window.open(n.content[0].attachment.url,n.description||this.$t("documents.unknownTitle"),"height="+(.7*window.innerHeight).toString()+",width="+(.7*window.innerWidth).toString())},checkIfIsAllergy(e){return"application/fhir+json"===e.content[0].attachment.contentType&&void 0!==e.type&&void 0!==e.type.coding&&e.type.coding.findIndex((e=>"722446000"===e.code))>-1},getAllergyName(e){var t;const n=null===(t=e.code.coding)||void 0===t?void 0:t.find((e=>e.system&&"http://snomed.info/sct"===e.system));if(n&&n.code){const e=u.bt.find((e=>e.defaultCoding.code===n.code));return(null===e||void 0===e?void 0:e.languageDisplays[this.lang])||this.$t("common.unknown")}return this.$t("common.unknown")},checkIfIsDocumentBundle(e){return"Bundle"===e.resourceType&&e.type===i.BundleType.DOCUMENT}}});var s=n(1639),c=n(4458),r=n(3190),p=n(2074),m=n(2857),g=n(2146),h=n(9984),w=n.n(h);const y=(0,s.Z)(d,[["render",a],["__scopeId","data-v-29e2afac"]]),f=y;w()(d,"components",{QCard:c.Z,QCardSection:r.Z,QDialog:p.Z,QIcon:m.Z}),w()(d,"directives",{ClosePopup:g.Z})}}]);
"use strict";(globalThis["webpackChunkmhealth_proto_patient"]=globalThis["webpackChunkmhealth_proto_patient"]||[]).push([[974],{3658:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(9835);function s(e,t,a,s,i,n){const o=(0,l.up)("q-option-group");return(0,l.wg)(),(0,l.j4)(o,{modelValue:e.values,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.values=t),e.updateDashboardSettings],options:e.options,type:"toggle"},null,8,["modelValue","options","onUpdate:modelValue"])}const i=(0,l.aZ)({name:"DashboardSettings",data(){return{dashboardOptions:this.$store.getDashboardSettings(),values:[],options:[]}},created(){var e;this.values=[],this.options=[];for(const t of this.dashboardOptions)t.active&&this.values.push(t.component),null===(e=this.options)||void 0===e||e.push({label:this.$t("settings."+t.component),value:t.component})},methods:{updateDashboardSettings(e){this.$store.setDashboardSettings(e),this.$emit("dashboardSettingsChanged")}}});var n=a(1639),o=a(5261),r=a(9984),d=a.n(r);const c=(0,n.Z)(i,[["render",s]]),u=c;d()(i,"components",{QOptionGroup:o.Z})},4974:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Mt});var l=a(9835);const s={class:"full-width row justify-around"};function i(e,t,a,i,n,o){const r=(0,l.up)("TimelineCard"),d=(0,l.up)("AllergyCard"),c=(0,l.up)("DiaryEntryCard"),u=(0,l.up)("DiaryListCard"),g=(0,l.up)("CalendarCard"),y=(0,l.up)("q-dialog"),p=(0,l.up)("DashboardFAB");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",s,[e.showTimelineCard?((0,l.wg)(),(0,l.j4)(r,{key:0,diary:e.diary,dayOffset:e.offset},null,8,["diary","dayOffset"])):(0,l.kq)("",!0),e.showAllergyCard?((0,l.wg)(),(0,l.j4)(d,{key:1,confirmedAllergies:e.$store.getKnownAllergies(!0),suspectedAllergies:e.$store.getSuspectedAllergiesAsFhir((t=>e.$t("symptom."+t))),entriesPerPage:5},null,8,["confirmedAllergies","suspectedAllergies"])):(0,l.kq)("",!0),e.showNewEntryCard?((0,l.wg)(),(0,l.j4)(c,{key:2,entry:void 0,dashBoardMode:"",onCreateEntry:e.createEntry},null,8,["onCreateEntry"])):(0,l.kq)("",!0),e.showDiaryListCard?((0,l.wg)(),(0,l.j4)(u,{key:3,diary:e.diary,entriesPerPage:5,onSelectedEntry:e.showEntry,onRequestNewEntry:t[0]||(t[0]=t=>{e.displayEntry=void 0,e.diaryDialog=!0})},null,8,["diary","onSelectedEntry"])):(0,l.kq)("",!0),e.showCalendarCard?((0,l.wg)(),(0,l.j4)(g,{key:4,diary:e.diary},null,8,["diary"])):(0,l.kq)("",!0),e.showDiaryListCard?((0,l.wg)(),(0,l.j4)(y,{key:5,modelValue:e.diaryDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.diaryDialog=t),"no-backdrop-dismiss":"",class:"dialog"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{entry:e.displayEntry,onClose:t[1]||(t[1]=t=>e.diaryDialog=!1),onCreateEntry:e.createEntry},null,8,["entry","onCreateEntry"])])),_:1},8,["modelValue"])):(0,l.kq)("",!0)]),(0,l.Wm)(p,{onOffsetChanged:e.offsetChanged,onDashboardSettingsChanged:e.dashboardSettingsChanged},null,8,["onOffsetChanged","onDashboardSettingsChanged"])],64)}var n=a(6970),o=a(1957);const r=e=>((0,l.dD)("data-v-09814e6c"),e=e(),(0,l.Cn)(),e),d={key:0,class:"row"},c={class:"col-4"},u={class:"form-label"},g={class:"col-8"},y={class:"datetime-wrapper"},p={key:1},m={key:2,class:"row"},h={class:"col-4"},w={class:"form-label"},f={class:"col-8"},b={key:0,style:{"text-align":"left","font-size":"small"}},D={class:"editable-list"},k={class:"radio-group"},C={class:"intensity-label"},A=r((()=>(0,l._)("br",null,null,-1))),$={key:0},v=r((()=>(0,l._)("hr",null,null,-1))),_={key:3,class:"row"},q={class:"col-4"},S={class:"form-label"},E={class:"col-8"},P={key:0,style:{"text-align":"left","font-size":"small"}},L={key:3,class:"display"},V={key:4},x={key:5,class:"row"},Z={class:"col-4"},W={class:"form-label"},z={class:"col-8"},O={key:0,class:"display-note"},T=["placeholder"],U={key:0};function M(e,t,a,s,i,r){const M=(0,l.up)("q-icon"),Q=(0,l.up)("q-card-section"),j=(0,l.up)("q-date"),Y=(0,l.up)("q-time"),I=(0,l.up)("q-popup-edit"),B=(0,l.up)("q-select"),N=(0,l.up)("q-radio"),H=(0,l.up)("q-btn"),F=(0,l.up)("q-card-actions"),K=(0,l.up)("q-card"),R=(0,l.up)("suspected-allergies-card"),X=(0,l.up)("q-dialog"),G=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(K,{class:(0,n.C_)((e.dashBoardMode," dashboard-card"))},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{class:(0,n.C_)("card-title"+(e.dashBoardMode?"":" with-close-icon"))},{default:(0,l.w5)((()=>[e.dashBoardMode?((0,l.wg)(),(0,l.j4)(M,{key:0,name:"fas fa-book-medical",class:"big-icon"})):(0,l.kq)("",!0),(0,l.Uk)(" "+(0,n.zw)("display"===e.mode?e.$t("diary.title")+" "+new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(e.date):e.$t("diary.createTitle"))+" ",1),e.dashBoardMode?(0,l.kq)("",!0):(0,l.wy)(((0,l.wg)(),(0,l.j4)(M,{key:1,onClick:t[0]||(t[0]=t=>e.$emit("close")),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512)),[[G]])])),_:1},8,["class"]),(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>["create"===e.mode?((0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",c,[(0,l._)("span",u,(0,n.zw)(e.$t("diary.dateLabel")),1)]),(0,l._)("div",g,[(0,l._)("span",{class:(0,n.C_)("create"===e.mode?"editable":"")},[(0,l.Uk)((0,n.zw)("function"===typeof e.date.getMonth?new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(e.date):e.date)+" ",1),"create"===e.mode?((0,l.wg)(),(0,l.j4)(I,{key:0,modelValue:e.date,"onUpdate:modelValue":t[1]||(t[1]=t=>e.date=t),"auto-save":"",title:e.$t("diary.editDate"),onBeforeHide:t[2]||(t[2]=()=>{e.date=new Date(e.date)}),buttons:"","label-set":e.$t("common.save")},{default:(0,l.w5)((e=>[(0,l._)("div",y,[(0,l.Wm)(j,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,mask:"YYYY-MM-DD HH:mm",style:{"margin-right":"1em"},minimal:"",flat:""},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(Y,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,mask:"YYYY-MM-DD HH:mm",flat:""},null,8,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","title","label-set"])):(0,l.kq)("",!0)],2)])])):(0,l.kq)("",!0),"create"===e.mode?((0,l.wg)(),(0,l.iD)("hr",p)):(0,l.kq)("",!0),e.symptoms.length>0||"create"===e.mode?((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("div",h,[(0,l._)("span",w,(0,n.zw)(e.$t("diary.symptomsLabel")),1)]),(0,l._)("div",f,["create"===e.mode?((0,l.wg)(),(0,l.iD)("p",b,(0,n.zw)(e.$t("diary.symptomsHint")),1)):(0,l.kq)("",!0),(0,l._)("ul",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.symptoms,((t,a)=>((0,l.wg)(),(0,l.iD)("li",{key:a},[(0,l._)("span",{class:(0,n.C_)("create"===e.mode?"editable":"")},[(0,l.Uk)((0,n.zw)(e.$t("symptom."+t.location.name))+" ("+(0,n.zw)(e.$t("symptom."+t.intensity))+") ",1),"create"===e.mode?((0,l.wg)(),(0,l.j4)(I,{key:0,modelValue:e.symptoms[a],"onUpdate:modelValue":t=>e.symptoms[a]=t,"auto-save":"",buttons:"",title:e.$t("diary.newSymptom"),"label-set":e.$t("common.save"),validate:()=>e.validateSymptom(e.symptoms[a])},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{modelValue:e.symptoms[a].location,"onUpdate:modelValue":t=>e.symptoms[a].location=t,label:e.$t("symptom.location"),autofocus:"",options:e.symptomLocations,"option-label":t=>t&&t.name?e.$t("symptom."+t.name):""},null,8,["modelValue","onUpdate:modelValue","label","options","option-label"]),(0,l._)("div",k,[(0,l._)("span",C,(0,n.zw)(e.$t("diary.intensity")),1),(0,l.Wm)(N,{modelValue:e.symptoms[a].intensity,"onUpdate:modelValue":t=>e.symptoms[a].intensity=t,val:"255604002",size:"xs"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("symptom.255604002")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(N,{modelValue:e.symptoms[a].intensity,"onUpdate:modelValue":t=>e.symptoms[a].intensity=t,val:"6736007",size:"md"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("symptom.6736007")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(N,{modelValue:e.symptoms[a].intensity,"onUpdate:modelValue":t=>e.symptoms[a].intensity=t,val:"24484000",size:"xl"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("symptom.24484000")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),A,(0,l.Wm)(N,{modelValue:e.symptoms[a].intensity,"onUpdate:modelValue":t=>e.symptoms[a].intensity=t,val:"260413007"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("symptom.260413007")),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:2},1032,["modelValue","onUpdate:modelValue","title","label-set","validate"])):(0,l.kq)("",!0)],2),"create"===e.mode?((0,l.wg)(),(0,l.j4)(M,{key:0,name:"fas fa-trash",class:"add-delete-icon",onClick:()=>e.symptoms.splice(a,1)},null,8,["onClick"])):(0,l.kq)("",!0),"create"===e.mode&&a===e.symptoms.length-1?((0,l.wg)(),(0,l.j4)(M,{key:1,name:"fas fa-plus",class:"inline-icon add-delete-icon",onClick:e.addNewSymptom},null,8,["onClick"])):(0,l.kq)("",!0)])))),128)),0===e.symptoms.length?((0,l.wg)(),(0,l.iD)("li",$,[(0,l._)("span",{class:"editable",onClick:t[3]||(t[3]=(...t)=>e.addNewSymptom&&e.addNewSymptom(...t))},(0,n.zw)(e.$t("diary.noSymptoms")),1),(0,l.Wm)(M,{name:"fas fa-plus",class:"inline-icon add-delete-icon",onClick:e.addNewSymptom},null,8,["onClick"])])):(0,l.kq)("",!0)])])])):(0,l.kq)("",!0),v,e.allergy||"create"===e.mode?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",q,[(0,l._)("span",S,(0,n.zw)(e.$t("diary.allergyLabel")),1)]),(0,l._)("div",E,["create"===e.mode?((0,l.wg)(),(0,l.iD)("p",P,(0,n.zw)(e.$t("diary.allergyHint")),1)):(0,l.kq)("",!0),"create"===e.mode&&(e.availableAllergies.length>0||e.suspectedAllergies.length>0)?((0,l.wg)(),(0,l.j4)(B,{key:1,modelValue:e.allergy,"onUpdate:modelValue":t[4]||(t[4]=t=>e.allergy=t),options:e.availableAllergies,"options-dense":"",dense:"","option-label":t=>t?t.languageDisplays[e.lang]:"keine Allergie",clearable:""},null,8,["modelValue","options","option-label"])):(0,l.kq)("",!0),"create"===e.mode?((0,l.wg)(),(0,l.j4)(H,{key:2,onClick:t[5]||(t[5]=t=>e.showSuspectedAllergiesPopup=!0),label:e.$t("suspectedAllergies.button"),class:"add-suspected-button",flat:"",size:"sm"},null,8,["label"])):(0,l.kq)("",!0),"display"===e.mode?((0,l.wg)(),(0,l.iD)("span",L,(0,n.zw)(e.allergy?e.allergy.languageDisplays[e.lang]:""),1)):(0,l.kq)("",!0)])])):(0,l.kq)("",!0),e.allergy||"create"===e.mode?((0,l.wg)(),(0,l.iD)("hr",V)):(0,l.kq)("",!0),"create"===e.mode||e.note&&e.note.length>0?((0,l.wg)(),(0,l.iD)("div",x,[(0,l._)("div",Z,[(0,l._)("span",W,(0,n.zw)(e.$t("diary.noteLabel")),1)]),(0,l._)("div",z,["display"===e.mode?((0,l.wg)(),(0,l.iD)("p",O,(0,n.zw)(e.note),1)):(0,l.kq)("",!0),"create"===e.mode?(0,l.wy)(((0,l.wg)(),(0,l.iD)("textarea",{key:1,"onUpdate:modelValue":t[6]||(t[6]=t=>e.note=t),placeholder:e.$t("diary.noteHint"),class:"edit-note editable"},"\n          ",8,T)),[[o.nr,e.note]]):(0,l.kq)("",!0)])])):(0,l.kq)("",!0)])),_:1}),"create"===e.mode?((0,l.wg)(),(0,l.iD)("hr",U)):(0,l.kq)("",!0),"create"===e.mode?((0,l.wg)(),(0,l.j4)(F,{key:1,align:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{label:e.$t("common.save"),onClick:e.saveEntry,disable:e.disableButton},null,8,["label","onClick","disable"])])),_:1})):(0,l.kq)("",!0)])),_:1},8,["class"]),(0,l.Wm)(X,{modelValue:e.showSuspectedAllergiesPopup,"onUpdate:modelValue":t[7]||(t[7]=t=>e.showSuspectedAllergiesPopup=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{availableAllergies:e.allergyCodes,suspectedAllergies:e.suspectedAllergies,onClose:e.onCloseSuspectedAllergiesPopup},null,8,["availableAllergies","suspectedAllergies","onClose"])])),_:1},8,["modelValue"])],64)}var Q=a(8852),j=a(5993);const Y=[{name:"eye",sct:"81745001",image:"eye.json"},{name:"nose",sct:"45206002",image:"nose.json"},{name:"mouth",sct:"312533001",image:"throat.json"},{name:"lung",sct:"39607008",image:"lung.json"},{name:"skin",sct:"39937001",image:"skin.json"},{name:"gastro",sct:"122865005",image:"digestive.json"}],I=["onClick"];function B(e,t,a,s,i,o){const r=(0,l.up)("q-icon"),d=(0,l.up)("q-card-section"),c=(0,l.up)("q-select"),u=(0,l.up)("q-btn"),g=(0,l.up)("q-card-actions"),y=(0,l.up)("q-card"),p=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(y,{class:"suspected-allergies-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("suspectedAllergies.title"))+" ",1),(0,l.wy)((0,l.Wm)(r,{onClick:t[0]||(t[0]=t=>e.$emit("close",{save:!1,allergies:[]})),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[p]])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("p",null,(0,n.zw)(e.$t("suspectedAllergies.explanation")),1),(0,l.Wm)(c,{modelValue:e.allergies,"onUpdate:modelValue":t[1]||(t[1]=t=>e.allergies=t),label:e.$t("common.typeForSearch"),options:e.searchAllergies,multiple:"","options-dense":"","hide-selected":"","use-input":"","option-label":t=>t&&t.languageDisplays[e.lang],onFilter:t[2]||(t[2]=(t,a)=>{const l=t.toLowerCase();""!==t&&a((()=>{e.searchAllergies=e.availableAllergies.filter((t=>t.languageDisplays[e.lang].toLowerCase().includes(l)))}))})},null,8,["modelValue","label","options","option-label"]),(0,l._)("ul",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.allergies,((t,a)=>((0,l.wg)(),(0,l.iD)("li",{key:t.defaultCoding.code},[(0,l.Uk)((0,n.zw)(t.languageDisplays[e.lang])+" ",1),(0,l._)("span",{onClick:()=>e.allergies.splice(a,1),class:"delete-x"}," [ "+(0,n.zw)(e.$t("common.remove"))+" ] ",9,I)])))),128))])])),_:1}),(0,l.Wm)(g,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:e.$t("common.save"),onClick:t[3]||(t[3]=t=>e.$emit("close",{save:!0,allergies:e.allergies}))},null,8,["label"])])),_:1})])),_:1})}const N=(0,l.aZ)({name:"SuspectedAllergiesCard",data(){return{allergies:this.suspectedAllergies.slice(),searchAllergies:this.availableAllergies.slice(),lang:this.$i18n.locale.substring(0,2)}},emits:{close:e=>!0},props:{availableAllergies:{type:Array,required:!0},suspectedAllergies:{type:Array,required:!0}},methods:{}});var H=a(1639),F=a(4458),K=a(3190),R=a(2857),X=a(6384),G=a(1821),J=a(4455),ee=a(2146),te=a(9984),ae=a.n(te);const le=(0,H.Z)(N,[["render",B],["__scopeId","data-v-0c28e746"]]),se=le;var ie;ae()(N,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QSelect:X.Z,QCardActions:G.Z,QBtn:J.Z}),ae()(N,"directives",{ClosePopup:ee.Z}),function(e){e["DISPLAY"]="display",e["CREATE"]="create"}(ie||(ie={}));const ne={intensity:j.Bs.NONE,location:{name:"unknown",sct:"261665006",image:"none.json"}},oe=(0,l.aZ)({name:"DiaryEntryCard",components:{SuspectedAllergiesCard:se},data(){return{mode:this.$props.entry?ie.DISPLAY:ie.CREATE,date:new Date,symptoms:new Array,note:void 0,allergy:void 0,symptomLocations:Y,knownAllergyCodes:new Array,availableAllergies:new Array,suspectedAllergies:new Array,allergyCodes:new Array,lang:this.$i18n.locale.substring(0,2),showSuspectedAllergiesPopup:!1}},emits:{"create-entry":e=>void 0!==e.date,close:()=>!0},props:{entry:{type:Object,required:!1},dashBoardMode:{type:Boolean,required:!1}},beforeMount(){this.knownAllergyCodes=this.$store.getKnownAllergies().map((e=>{const t=e.code.coding?e.code.coding.find((e=>"http://snomed.info/sct"===e.system)):void 0;let a=Q.bt[0];return t&&t.code&&(a=Q.bt.find((e=>e.defaultCoding.code===t.code))||a),a})),this.suspectedAllergies=this.$store.getSuspectedAllergies(),this.resetAllergyCodes()},mounted(){this.$props.entry&&Object.assign(this,this.$props.entry),this.resetAvailableAllergies()},computed:{disableButton(){var e;return(0===this.symptoms.length||1===this.symptoms.length&&this.symptoms[0]===ne)&&(void 0==this.note||0===(null===(e=this.note)||void 0===e?void 0:e.length))&&void 0==this.allergy}},methods:{saveEntry(){this.$emit("create-entry",{date:new Date(this.date),symptoms:[...this.symptoms.filter((e=>"unknown"!==e.location.name))],note:this.note&&this.note.length>0?this.note:void 0,allergy:this.allergy?Object.assign({},this.allergy):void 0}),this.resetForm(),this.dashBoardMode||this.$emit("close")},resetForm(){this.date=new Date,this.symptoms=[],this.note="",this.allergy=void 0},onCloseSuspectedAllergiesPopup(e){e.save&&(this.suspectedAllergies=e.allergies,this.$store.setSuspectedAllergies(e.allergies),this.resetAvailableAllergies()),this.showSuspectedAllergiesPopup=!1},addNewSymptom(){this.symptoms.push(Object.assign({},ne))},validateSymptom(e){return void 0!==e.location&&"261665006"!==e.location.sct||(alert(this.$t("diary.locationAlert")),!1)},resetAvailableAllergies(){function e(e,t){const a=new Array;return e.forEach((e=>a.push(e))),t.forEach((t=>{-1===e.findIndex((e=>e.defaultCoding.code===t.defaultCoding.code))&&a.push(t)})),a}this.availableAllergies=e(this.knownAllergyCodes,this.suspectedAllergies).filter((e=>e.defaultCoding.display&&!e.defaultCoding.display.includes("No known"))).sort(((e,t)=>(e.defaultCoding.display||"").localeCompare(t.defaultCoding.display||"")))},resetAllergyCodes(){this.allergyCodes=Q.bt.filter((e=>{var t,a;return!this.suspectedAllergies.includes(e)&&!this.knownAllergyCodes.includes(e)&&!(null===(t=e.defaultCoding.display)||void 0===t?void 0:t.includes("No known"))&&!(null===(a=e.defaultCoding.display)||void 0===a?void 0:a.includes("Allergy to"))}))}},watch:{}});var re=a(9843),de=a(4351),ce=a(6770),ue=a(1480),ge=a(2074);const ye=(0,H.Z)(oe,[["render",M],["__scopeId","data-v-09814e6c"]]),pe=ye;ae()(oe,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QPopupEdit:re.Z,QDate:de.Z,QTime:ce.Z,QSelect:X.Z,QRadio:ue.Z,QBtn:J.Z,QCardActions:G.Z,QDialog:ge.Z}),ae()(oe,"directives",{ClosePopup:ee.Z});const me=e=>((0,l.dD)("data-v-168fce46"),e=e(),(0,l.Cn)(),e),he={class:"intro-text"},we={key:0,class:"no-data-text"},fe={class:"diary-entries"},be=["onClick"],De={class:"diary-entry-button-title"},ke={class:"diary-entry-button-date"},Ce={key:1,class:"diary-pages"},Ae=["onClick"],$e={key:0},ve=me((()=>(0,l._)("hr",null,null,-1)));function _e(e,t,a,s,i,o){const r=(0,l.up)("q-icon"),d=(0,l.up)("q-card-section"),c=(0,l.up)("q-btn"),u=(0,l.up)("q-card-actions"),g=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(g,{class:"dashboard-card diary-list-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"fas fa-book",class:"big-icon"}),(0,l.Uk)(" "+(0,n.zw)(e.$t("index.diaryTitle")),1)])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("p",he,(0,n.zw)(e.$t("index.diaryText")),1),0===e.diary.length?((0,l.wg)(),(0,l.iD)("p",we,(0,n.zw)(e.$t("diary.noData")),1)):(0,l.kq)("",!0),(0,l._)("ul",fe,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.diaryEntries,((t,a)=>((0,l.wg)(),(0,l.iD)("li",{key:"diaryEntry."+a},[(0,l._)("div",{class:"diary-entry-button",onClick:a=>e.$emit("selected-entry",t)},[(0,l._)("p",De,(0,n.zw)(e.$t("diary.title")),1),(0,l._)("p",ke,(0,n.zw)(new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"medium",timeStyle:"short"}).format(t.date)),1)],8,be)])))),128))]),e.diaryPages>1?((0,l.wg)(),(0,l.iD)("ul",Ce,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.diaryPages,(t=>((0,l.wg)(),(0,l.iD)("li",{key:"pagebutton"+t},[(0,l._)("span",{onClick:()=>e.setDiaryPage(t),class:(0,n.C_)(t===e.currentDiaryPage?"clickable current-page":"clickable")},"  "+(0,n.zw)(t)+"  ",11,Ae),t!==e.diaryPages?((0,l.wg)(),(0,l.iD)("span",$e,"•")):(0,l.kq)("",!0)])))),128))])):(0,l.kq)("",!0)])),_:1}),ve,(0,l.Wm)(u,{align:"center",class:"card-actions"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:e.$t("diary.createTitle"),onClick:t[0]||(t[0]=t=>e.$emit("request-new-entry"))},null,8,["label"])])),_:1})])),_:1})}const qe=(0,l.aZ)({name:"DiaryListCard",components:{},data(){return{diaryEntries:new Array,diaryPages:0,currentDiaryPage:0}},emits:{"selected-entry":e=>void 0!==e.date,"request-new-entry":()=>!0},props:{diary:{type:Array,required:!0},entriesPerPage:{type:Number,required:!0}},mounted(){this.setDiaryPage(1),this.diaryPages=Math.ceil(this.$props.diary.length/this.$props.entriesPerPage)},watch:{diary(e){this.diaryEntries=e,this.setDiaryPage(-1)}},methods:{setDiaryPage(e){this.diaryPages=Math.ceil(this.$props.diary.length/this.$props.entriesPerPage),this.currentDiaryPage=-1===e?this.diaryPages:e;const t=(this.currentDiaryPage-1)*this.$props.entriesPerPage;this.diaryEntries=this.$props.diary.slice(t,t+this.$props.entriesPerPage)}}}),Se=(0,H.Z)(qe,[["render",_e],["__scopeId","data-v-168fce46"]]),Ee=Se;ae()(qe,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QCardActions:G.Z,QBtn:J.Z});const Pe={class:"allergy-button-list"},Le=["onClick"],Ve={key:0,class:"allergy-button-type"},xe={class:"allergy-button-name"},Ze={key:0,class:"no-entries"},We={key:1,class:"pages"},ze=["onClick"],Oe={key:0},Te={class:"allergy-button-list"},Ue=["onClick"],Me={class:"allergy-button-type"},Qe={class:"allergy-button-name"},je={key:0,class:"no-entries"},Ye={key:1,class:"pages"},Ie=["onClick"],Be={key:0};function Ne(e,t,a,s,i,o){const r=(0,l.up)("q-icon"),d=(0,l.up)("q-card-section"),c=(0,l.up)("q-tab"),u=(0,l.up)("q-tabs"),g=(0,l.up)("q-card"),y=(0,l.up)("AllergyView"),p=(0,l.up)("q-dialog"),m=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(g,{class:"dashboard-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"fas fa-stethoscope",class:"big-icon"}),(0,l.Uk)(" "+(0,n.zw)(e.$t("allergy.title")),1)])),_:1}),e.suspectedAllergies?((0,l.wg)(),(0,l.j4)(u,{key:0,modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{name:"known",label:e.$t(e.smallScreen?"allergy.tabKnownShort":"allergy.tabKnown")},null,8,["label"]),(0,l.Wm)(c,{name:"suspected",label:e.$t(e.smallScreen?"allergy.tabSuspectedShort":"allergy.tabSuspected")},null,8,["label"])])),_:1},8,["modelValue"])):(0,l.kq)("",!0),"known"!==e.tab&&e.suspectedAllergies?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(d,{key:1},{default:(0,l.w5)((()=>[(0,l._)("ul",Pe,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.allergies.known,(t=>((0,l.wg)(),(0,l.iD)("li",{key:t.id,class:"clickable allergy-button",onClick:()=>{e.detailDialog=!0,e.selectedAllergy=t}},[t.type?((0,l.wg)(),(0,l.iD)("p",Ve,(0,n.zw)(e.$t("common."+t.type)),1)):(0,l.kq)("",!0),(0,l._)("p",xe,(0,n.zw)(e.getAllergyName(t)),1)],8,Le)))),128))]),0===e.allergies.known.length?((0,l.wg)(),(0,l.iD)("p",Ze,(0,n.zw)(e.$t("allergy.noEntries")),1)):(0,l.kq)("",!0),e.pages.known>1?((0,l.wg)(),(0,l.iD)("ul",We,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pages.known,(t=>((0,l.wg)(),(0,l.iD)("li",{key:"knownpagebutton"+t},[(0,l._)("span",{onClick:()=>e.setAllergyPage(t,"known"),class:(0,n.C_)(t===e.currentPage.known?"clickable current-page":"clickable")},"  "+(0,n.zw)(t)+"  ",11,ze),t!==e.pages.known?((0,l.wg)(),(0,l.iD)("span",Oe,"•")):(0,l.kq)("",!0)])))),128))])):(0,l.kq)("",!0)])),_:1})),"suspected"===e.tab?((0,l.wg)(),(0,l.j4)(d,{key:2},{default:(0,l.w5)((()=>[(0,l._)("ul",Te,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.allergies.suspected,(t=>((0,l.wg)(),(0,l.iD)("li",{key:t.id,class:"clickable allergy-button",onClick:()=>{e.detailDialog=!0,e.selectedAllergy=t}},[(0,l._)("p",Me,(0,n.zw)(e.$t("allergy.suspectedSubtitle")),1),(0,l._)("p",Qe,(0,n.zw)(e.getAllergyName(t)),1)],8,Ue)))),128))]),0===e.allergies.suspected.length?((0,l.wg)(),(0,l.iD)("p",je,(0,n.zw)(e.$t("allergy.noEntries")),1)):(0,l.kq)("",!0),e.pages.suspected>1?((0,l.wg)(),(0,l.iD)("ul",Ye,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.pages.suspected,(t=>((0,l.wg)(),(0,l.iD)("li",{key:"knownpagebutton"+t},[(0,l._)("span",{onClick:()=>e.setAllergyPage(t,"suspected"),class:(0,n.C_)(t===e.currentPage.suspected?"clickable current-page":"clickable")},"  "+(0,n.zw)(t)+"  ",11,Ie),t!==e.pages.suspected?((0,l.wg)(),(0,l.iD)("span",Be,"•")):(0,l.kq)("",!0)])))),128))])):(0,l.kq)("",!0)])),_:1})):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(p,{modelValue:e.detailDialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.detailDialog=t),class:"dialog"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"allergy-dialog-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title with-close-icon"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.selectedAllergy?e.getAllergyName(e.selectedAllergy):"")+" ",1),(0,l.wy)((0,l.Wm)(r,{onClick:t[1]||(t[1]=()=>{e.detailDialog=!1,e.selectedAllergy=void 0}),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[m]])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{allergyIntolerance:e.selectedAllergy,translations:e.allergyStrings,languageString:e.$store.getSettings().language.substring(0,2)||"de",fhirUtils:e.$fhirUtils,epdPlaygroundUtils:e.$epdUtils,showTitle:!1},null,8,["allergyIntolerance","translations","languageString","fhirUtils","epdPlaygroundUtils"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const He=(0,l.aZ)({name:"AllergyCard",components:{AllergyView:Q.HY},data(){return{lang:this.$i18n.locale.substring(0,2),smallScreen:window.innerWidth<400,allergies:{known:new Array,suspected:new Array},allergyStrings:{allergy:this.$t("allergy.allergy"),intolerance:this.$t("allergy.intolerance"),typeLabel:this.$t("allergy.typeLabel"),codeDisplayLabel:this.$t("allergy.codeDisplayLabel"),dateLabel:this.$t("common.date"),clinicalStateLabel:this.$t("allergy.clinicalStateLabel"),verificationStateLabel:this.$t("allergy.verificationStateLabel"),reactionLabel:this.$t("allergy.reactionLabel"),reactionsLabel:this.$t("allergy.reactionsLabel"),reactionDateLabel:this.$t("allergy.reactionDateLabel"),reactionSubstanceLabel:this.$t("allergy.reactionSubstanceLabel"),reactionSeverityLabel:this.$t("allergy.reactionSeverityLabel"),reactionDescriptionLabel:this.$t("allergy.reactionDescriptionLabel"),additionalInformation:this.$t("allergy.additionalInformation"),categoryLabel:this.$t("allergy.categoryLabel"),criticalityLabel:this.$t("allergy.criticalityLabel"),noteLabel:this.$t("allergy.noteLabel"),exposureDateLabel:this.$t("allergy.exposureDateLabel"),exposureRouteLabel:this.$t("allergy.exposureRouteLabel"),reactionNoteLabel:this.$t("allergy.reactionNoteLabel"),reactionLocationLabel:this.$t("allergy.reactionLocationLabel"),noOtherDataAvailable:this.$t("allergy.noOtherDataAvailable")},pages:{known:0,suspected:0},currentPage:{known:0,suspected:0},tab:"known",detailDialog:!1,selectedAllergy:void 0}},props:{confirmedAllergies:{type:Object,required:!0},suspectedAllergies:{type:Object,required:!1},entriesPerPage:{type:Number,required:!0}},beforeMount(){var e;this.setAllergyPage(1,"known"),this.$props.suspectedAllergies&&this.setAllergyPage(1,"suspected"),this.pages={known:Math.ceil(this.$props.confirmedAllergies.length/this.$props.entriesPerPage),suspected:Math.ceil(((null===(e=this.$props.suspectedAllergies)||void 0===e?void 0:e.length)||0)/this.$props.entriesPerPage)}},watch:{suspectedAllergies(){this.setAllergyPage(-1,"suspected")},confirmedAllergies(){this.setAllergyPage(-1,"known")}},methods:{getAllergyName(e){var t;const a=null===(t=e.code.coding)||void 0===t?void 0:t.find((e=>e.system&&"http://snomed.info/sct"===e.system));if(a&&a.code){const e=Q.bt.find((e=>e.defaultCoding.code===a.code));return(null===e||void 0===e?void 0:e.languageDisplays[this.lang])||this.$t("common.unknown")}return this.$t("common.unknown")},setAllergyPage(e,t){const a="known"===t?this.$props.confirmedAllergies:this.$props.suspectedAllergies||[];this.pages[t]=Math.ceil(a.length/this.$props.entriesPerPage),this.currentPage[t]=-1===e?this.pages[t]:e;const l=(this.currentPage[t]-1)*this.$props.entriesPerPage;this.allergies[t]=a.slice(l,l+this.$props.entriesPerPage)}}});var Fe=a(7817),Ke=a(900);const Re=(0,H.Z)(He,[["render",Ne]]),Xe=Re;ae()(He,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QTabs:Fe.Z,QTab:Ke.Z,QDialog:ge.Z}),ae()(He,"directives",{ClosePopup:ee.Z});const Ge=e=>((0,l.dD)("data-v-26f1a753"),e=e(),(0,l.Cn)(),e),Je=["onClick"],et=Ge((()=>(0,l._)("hr",{width:"100%"},null,-1))),tt={key:0},at={key:0,class:"row justify-around full-width"},lt=["onClick"],st=Ge((()=>(0,l._)("hr",null,null,-1))),it={key:0},nt={key:0,class:"row justify-start full-width"},ot=["onClick"],rt={key:0,class:"no-data-text"},dt={class:"day-entry-list"},ct=["onClick"];function ut(e,t,a,s,i,o){const r=(0,l.up)("q-icon"),d=(0,l.up)("q-card-section"),c=(0,l.up)("q-card"),u=(0,l.up)("DiaryEntryCard"),g=(0,l.up)("q-dialog"),y=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(c,{class:"calendar-card dashboard-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"fas fa-calendar",class:"big-icon"}),(0,l.Uk)(" "+(0,n.zw)(e.$t("calendar.title")),1)])),_:1}),(0,l.Wm)(d,{class:"row justify-around"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.years,(t=>((0,l.wg)(),(0,l.iD)("div",{key:t.year,class:(0,n.C_)("row justify-evenly year-tile"+(t.expanded?" expanded":""))},[(0,l._)("div",{class:"date",onClick:a=>e.toggleExpanded(t,!t.expanded)},[(0,l._)("h1",null,(0,n.zw)(t.year),1),et,t.expanded?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("p",tt,(0,n.zw)(t.numberOfEntries+" "+(1===t.numberOfEntries?e.$t("calendar.entryLabel"):e.$t("calendar.entriesLabel"))),1))],8,Je),t.expanded?((0,l.wg)(),(0,l.iD)("div",at,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.months,(a=>((0,l.wg)(),(0,l.iD)("div",{key:t.year+"/"+a.month,class:(0,n.C_)("month-tile"+(a.expanded?" expanded":""))},[(0,l._)("div",{class:"date",onClick:t=>e.toggleExpanded(a,!a.expanded)},[(0,l._)("h1",null,(0,n.zw)(a.expanded||e.$t("common.month"+a.month).length<=4?e.$t("common.month"+a.month):e.$t("common.month"+a.month).substring(0,3)+"."),1),st,a.expanded?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("p",it,(0,n.zw)(a.numberOfEntries+" "+(1===a.numberOfEntries?e.$t("calendar.entryLabel"):e.$t("calendar.entriesLabel"))),1))],8,lt),a.expanded?((0,l.wg)(),(0,l.iD)("div",nt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.getDayArray(t.year,a.month),(s=>((0,l.wg)(),(0,l.iD)("div",{key:t.year+"/"+a.month+"/"+s,class:(0,n.C_)("day-entry"+(e.numberOfDayEntries(a.days,Number(s))>0?" with-entries":"")),onClick:()=>e.showDayPopup(a.days.find((e=>e.day.toString()===s)))},(0,n.zw)(s),11,ot)))),128))])):(0,l.kq)("",!0)],2)))),128))])):(0,l.kq)("",!0)],2)))),128)),0===e.years.length?((0,l.wg)(),(0,l.iD)("p",rt,(0,n.zw)(e.$t("diary.noData")),1)):(0,l.kq)("",!0)])),_:1})])),_:1}),(0,l.Wm)(g,{modelValue:e.dayDialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.dayDialog=t)},{default:(0,l.w5)((()=>{var a,s,i;return[1===(null===(a=e.selectedDay)||void 0===a?void 0:a.entries.length)?((0,l.wg)(),(0,l.j4)(u,{key:0,entry:null===(s=e.selectedDay)||void 0===s?void 0:s.entries[0],onClose:t[0]||(t[0]=t=>e.dayDialog=!1),onCreatedEntry:t[1]||(t[1]=()=>{})},null,8,["entry"])):(0,l.kq)("",!0),e.selectedDay&&(null===(i=e.selectedDay)||void 0===i?void 0:i.entries.length)>1?((0,l.wg)(),(0,l.j4)(c,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title with-close-icon"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("calendar.entriesFrom")+" "+new Intl.DateTimeFormat(e.$i18n.locale,{dateStyle:"long"}).format(e.selectedDay.fullDate))+" ",1),(0,l.wy)((0,l.Wm)(r,{onClick:t[2]||(t[2]=t=>e.dayDialog=!1),name:"fas fa-times",class:"close-icon",flat:"",round:"",dense:""},null,512),[[y]])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("ul",dt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.selectedDay.entries,((t,a)=>((0,l.wg)(),(0,l.iD)("li",{key:"entry"+a,onClick:()=>{e.subDayDialog=!0,e.subDayEntry=t}},(0,n.zw)(e.$t("calendar.entryTimeLabel1")+new Intl.DateTimeFormat(e.$i18n.locale,{timeStyle:"short"}).format(t.date)+e.$t("calendar.entryTimeLabel2")),9,ct)))),128))])])),_:1})])),_:1})):(0,l.kq)("",!0)]})),_:1},8,["modelValue"]),(0,l.Wm)(g,{modelValue:e.subDayDialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.subDayDialog=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{entry:e.subDayEntry,onClose:t[4]||(t[4]=t=>e.subDayDialog=!1)},null,8,["entry"])])),_:1},8,["modelValue"])],64)}const gt=(0,l.aZ)({name:"CalendarCard",components:{DiaryEntryCard:pe},data(){return{years:new Array,dayDialog:!1,subDayDialog:!1,selectedDay:void 0,subDayEntry:void 0,lang:this.$i18n.locale}},emits:{},props:{diary:{type:Array,required:!0}},mounted(){this.buildDataStructure(this.$props.diary)},methods:{toggleExpanded(e,t){e.expanded=t,!t&&e.hasOwnProperty("months")&&e.months.forEach((e=>{e.expanded&&this.toggleExpanded(e,!1)}))},numberOfDayEntries(e,t){const a=e.findIndex((e=>e.day===t));return-1===a?0:e[a].entries.length},showDayPopup(e){this.selectedDay=e,this.dayDialog=!0},getMonthLength(e,t){return 1===t&&e%4===0&&e%100!==0||e%400===0?29:[31,28,31,30,31,30,31,31,30,31,30,31][t]},getDayOfFirstDay(e,t){const a=new Date(e.toString()+"/"+(t+1).toString()+"/1");return a.getDay()},getDayArray(e,t){const a=this.getDayOfFirstDay(e,t),l=this.getMonthLength(e,t),s=new Array(0===a?6:a-1).map((()=>" "));for(let i=1;i<=l;i++)s.push(i.toString());return s},buildDataStructure(e){this.years=[],e.forEach((e=>{const t=e.date.getFullYear(),a=e.date.getMonth(),l=e.date.getDate(),s={year:t,numberOfEntries:1,expanded:!1,months:[{month:a,numberOfEntries:1,expanded:!1,days:[{day:l,fullDate:new Date(`${t}/${a+1}/${l}`),expanded:!1,entries:[e]}]}]};let i=!1;this.years.forEach((n=>{if(!i&&n.year===t){i=!0;let t=!1;n.months.forEach((i=>{if(!t&&i.month===a){t=!0;let a=!1;i.days.forEach((t=>{a||t.day!==l||(a=!0,t.entries.push(e),i.numberOfEntries++,n.numberOfEntries++)})),a||(i.days.push(s.months[0].days[0]),i.days.sort(((e,t)=>e.day-t.day)),i.numberOfEntries++,n.numberOfEntries++)}})),t||(n.months.push(s.months[0]),n.months.sort(((e,t)=>e.month-t.month)),n.numberOfEntries++)}})),i||(this.years.push(s),this.years.sort(((e,t)=>e.year-t.year)))}))}},watch:{diary(e){this.buildDataStructure(e)}}}),yt=(0,H.Z)(gt,[["render",ut],["__scopeId","data-v-26f1a753"]]),pt=yt;ae()(gt,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QDialog:ge.Z}),ae()(gt,"directives",{ClosePopup:ee.Z});const mt={key:1,class:"no-data-text no-data"},ht={class:"text-body1"};function wt(e,t,a,s,i,o){const r=(0,l.up)("q-icon"),d=(0,l.up)("q-card-section"),c=(0,l.up)("q-select"),u=(0,l.up)("GChart"),g=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(g,{class:"dashboard-card-wide gt-xs"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"fas fa-chart-line",class:"big-icon"}),(0,l.Uk)(" "+(0,n.zw)(e.$t("timeline.title")),1)])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:e.filter,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.filter=t),t[1]||(t[1]=t=>e.getChartData())],dense:"",multiple:"",options:e.availableAllergies,"option-label":t=>t?t.languageDisplays[e.lang]:e.$t("allergy.noAllergy"),"options-dense":"","use-chips":"","stack-label":"",label:e.$t("timeline.filter")},null,8,["modelValue","options","option-label","label"]),e.chartData.length>1?((0,l.wg)(),(0,l.j4)(u,{key:0,type:"LineChart",data:e.chartData,options:e.chartOptions,settings:{language:e.lang}},null,8,["data","options","settings"])):(0,l.kq)("",!0),e.chartData.length<2?((0,l.wg)(),(0,l.iD)("p",mt,(0,n.zw)(e.$t("diary.noData")),1)):(0,l.kq)("",!0)])),_:1})])),_:1}),(0,l.Wm)(g,{class:"dashboard-card lt-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"fas fa-chart-line",class:"big-icon"}),(0,l.Uk)(" "+(0,n.zw)(e.$t("timeline.title")),1)])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",ht,(0,n.zw)(e.$t("timeline.noShowText")),1)])),_:1})])),_:1})],64)}var ft=a(4281);function bt(e=new Date){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function Dt(e,t,a=new Date){if(-1!==t){a=bt(a);const l=864e5*t,s=new Date(a);return s.setTime(s.getTime()-l),e=e.filter((e=>e.date.getTime()>s.getTime())),e}return[...e]}const kt={dateTimeToDate:bt,filterByDate:Dt};var Ct=a(7861);const At=(0,l.aZ)({name:"TimelineCard",components:{GChart:ft.PQ},props:{diary:{type:Array,required:!0},dayOffset:{type:Number,required:!0}},data(){return{lang:(0,Ct.getLangStringFromLocale)(this.$i18n.locale),filter:new Array,knownAllergyCodes:new Array,suspectedAllergies:new Array,availableAllergies:new Array,chartData:[],chartOptions:{height:400,legend:"top",hAxis:{title:this.$t("timeline.xAxis"),format:"dd/MM/yyyy",ticks:[],minorGridlines:{count:0}},vAxis:{title:this.$t("timeline.yAxis"),ticks:[{v:0,f:this.$t("symptom.260413007")},{v:1,f:this.$t("symptom.255604002")},{v:2,f:this.$t("symptom.6736007")},{v:3,f:this.$t("symptom.24484000")}]},interpolateNulls:!0,curveType:"function",pointSize:5,series:{0:{pointShape:"circle"},1:{pointShape:"triangle"},2:{pointShape:"square"},3:{pointShape:"diamond"},4:{pointShape:"star"},5:{pointShape:"polygon"}}}}},beforeMount(){this.knownAllergyCodes=this.$store.getKnownAllergies().map((e=>{const t=e.code.coding?e.code.coding.find((e=>"http://snomed.info/sct"===e.system)):void 0;let a=Q.bt[0];return t&&t.code&&(a=Q.bt.find((e=>e.defaultCoding.code===t.code))||a),a})),this.suspectedAllergies=this.$store.getSuspectedAllergies()},mounted(){this.resetAvailableAllergies(),this.getChartData()},updated(){this.getChartData()},methods:{getChartData(){var e;let t=[],a=[this.$t("timeline.date")],l={},s={260413007:0,255604002:1,6736007:2,24484e3:3};for(let r=0;r<Y.length;r++)l[Y[r].sct]=r+1,a[r+1]=this.$t("symptom."+Y[r].name);t.push(a);let i=this.filterByAllergies(this.diary),n=null===(e=i.at(-1))||void 0===e?void 0:e.date;this.buildHAxis(n);for(const r of i){let e=[r.date,null,null,null,null,null,null];for(const t of r.symptoms){const a=l[t.location.sct];e[a]=s[t.intensity]}t.push(e)}let o=[];for(let r=1;r<Y.length+1;r++){let e=!0;for(let a=1;a<t.length;a++)null!==t[a][r]&&(e=!1);e&&o.push(r)}t=t.map((e=>e.filter(((e,t)=>-1===o.indexOf(t))))),this.chartData=t},filterByDate(e,t=new Date){t=kt.dateTimeToDate(t);let a=864e5*this.dayOffset,l=new Date(t);l.setTime(l.getTime()-a);for(let s=0;s<this.dayOffset+1;s++){let e=864e5*(this.dayOffset-s),a=new Date(t);a.setTime(t.getTime()-e),this.chartOptions.hAxis.ticks[s]=a}return e=e.filter((e=>e.date.getTime()>l.getTime())),e},filterByAllergies(e){return this.filter.length>0&&(e=e.filter((e=>this.filter.some((t=>{var a;return t.defaultCoding.code===(null===(a=e.allergy)||void 0===a?void 0:a.defaultCoding.code)}))))),e},buildHAxis(e=new Date){if(e=kt.dateTimeToDate(e),this.chartOptions.hAxis.ticks.length=0,-1===this.dayOffset){const t={"-12":0,"-11":1,"-10":2,"-9":3,"-8":4,"-7":5,"-6":6,"-5":7,"-4":8,"-3":9,"-2":10,"-1":11,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11};let a=e.getMonth(),l=e.getFullYear();this.chartOptions.hAxis.ticks.length=0;for(let e=a-11;e<=a;e++)e<0?this.chartOptions.hAxis.ticks.push(new Date(l-1,t[e])):this.chartOptions.hAxis.ticks.push(new Date(l,t[e]));this.chartOptions.hAxis.format="MMM YYYY"}else if(7===this.dayOffset){for(let t=0;t<this.dayOffset+1;t++){let a=864e5*(this.dayOffset-t),l=new Date(e);l.setTime(e.getTime()-a),this.chartOptions.hAxis.ticks[t]=l}this.chartOptions.hAxis.format="d MMM"}else{for(let t=this.dayOffset;t>-1;t-=2){let a=864e5*(this.dayOffset-t),l=new Date(e);l.setTime(e.getTime()-a),this.chartOptions.hAxis.ticks.push(l)}this.chartOptions.hAxis.format="d MMM"}},resetAvailableAllergies(){function e(e,t){const a=new Array;return e.forEach((e=>a.push(e))),t.forEach((t=>{-1===e.findIndex((e=>e.defaultCoding.code===t.defaultCoding.code))&&a.push(t)})),a}this.availableAllergies=e(this.knownAllergyCodes,this.suspectedAllergies).filter((e=>e.defaultCoding.display&&!e.defaultCoding.display.includes("No known"))).sort(((e,t)=>(e.defaultCoding.display||"").localeCompare(t.defaultCoding.display||"")))}}}),$t=(0,H.Z)(At,[["render",wt],["__scopeId","data-v-db601680"]]),vt=$t;ae()(At,"components",{QCard:F.Z,QCardSection:K.Z,QIcon:R.Z,QSelect:X.Z});const _t={class:"text-h6"},qt={class:"text-subtitle1"},St={class:"text-subtitle1"};function Et(e,t,a,s,i,o){const r=(0,l.up)("q-option-group"),d=(0,l.up)("DashboardSettings"),c=(0,l.up)("q-banner"),u=(0,l.up)("q-popup-proxy"),g=(0,l.up)("q-btn"),y=(0,l.up)("q-page-sticky");return(0,l.wg)(),(0,l.j4)(y,{position:"bottom-right",offset:[18,18]},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{fab:"",icon:"fas fa-cog",color:"accent"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{offset:[0,10]},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"q-mx-sm"},{default:(0,l.w5)((()=>[(0,l._)("div",_t,(0,n.zw)(e.$t("dashboardFAB.title")),1),(0,l._)("div",qt,(0,n.zw)(e.$t("dashboardFAB.entriesText")),1),(0,l.Wm)(r,{modelValue:e.offset,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.offset=t),e.offsetChanged],options:[{label:e.$t("dashboardFAB.allEntries"),value:-1},{label:e.$t("dashboardFAB.last30days"),value:30},{label:e.$t("dashboardFAB.last7days"),value:7}]},null,8,["modelValue","options","onUpdate:modelValue"]),(0,l._)("div",St,(0,n.zw)(e.$t("dashboardFAB.componentsText")),1),(0,l.Wm)(d,{onDashboardSettingsChanged:t[1]||(t[1]=t=>e.$emit("dashboardSettingsChanged"))})])),_:1})])),_:1})])),_:1})])),_:1})}var Pt=a(3658);const Lt=(0,l.aZ)({name:"DashboardFAB",components:{DashboardSettings:Pt.Z},data(){return{offset:this.$store.getDaysDisplayedOnDashboard()}},methods:{offsetChanged(e){this.$store.setDaysDisplayedOnDashboard(e),this.$emit("offsetChanged")}}});var Vt=a(627),xt=a(2765),Zt=a(8001),Wt=a(5261);const zt=(0,H.Z)(Lt,[["render",Et]]),Ot=zt;ae()(Lt,"components",{QPageSticky:Vt.Z,QBtn:J.Z,QPopupProxy:xt.Z,QBanner:Zt.Z,QOptionGroup:Wt.Z});const Tt=(0,l.aZ)({name:"DashboardPage",components:{DiaryEntryCard:pe,DiaryListCard:Ee,CalendarCard:pt,TimelineCard:vt,AllergyCard:Xe,DashboardFAB:Ot},data(){return{diary:new Array,displayEntry:void 0,diaryDialog:!1,showDiaryListCard:this.$store.getSettings().dashboard.includes(j.MX.DIARY_LIST),showCalendarCard:this.$store.getSettings().dashboard.includes(j.MX.CALENDAR),showNewEntryCard:this.$store.getSettings().dashboard.includes(j.MX.NEW_DIARY_ENTRY),showTimelineCard:this.$store.getSettings().dashboard.includes(j.MX.TIMELINE),showAllergyCard:this.$store.getSettings().dashboard.includes(j.MX.ALLERGIES),offset:this.$store.getDaysDisplayedOnDashboard()}},mounted(){this.diary=kt.filterByDate(this.$store.getDiary(),this.offset)},methods:{showEntry(e){this.displayEntry=e,this.diaryDialog=!0},createEntry(e){this.diary=kt.filterByDate(this.$store.addDiaryEntry(e),this.offset)},offsetChanged(){this.offset=this.$store.getDaysDisplayedOnDashboard(),this.diary=kt.filterByDate(this.$store.getDiary(),this.offset)},dashboardSettingsChanged(){this.showDiaryListCard=this.$store.getSettings().dashboard.includes(j.MX.DIARY_LIST),this.showCalendarCard=this.$store.getSettings().dashboard.includes(j.MX.CALENDAR),this.showNewEntryCard=this.$store.getSettings().dashboard.includes(j.MX.NEW_DIARY_ENTRY),this.showTimelineCard=this.$store.getSettings().dashboard.includes(j.MX.TIMELINE),this.showAllergyCard=this.$store.getSettings().dashboard.includes(j.MX.ALLERGIES)}}}),Ut=(0,H.Z)(Tt,[["render",i]]),Mt=Ut;ae()(Tt,"components",{QDialog:ge.Z})}}]);